"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3741],{76:(Z,E,i)=>{i.d(E,{GW:()=>a,dk:()=>v,oK:()=>s});var s=(()=>{return(y=s||(s={})).Prompt="PROMPT",y.Camera="CAMERA",y.Photos="PHOTOS",s;var y})(),a=(()=>{return(y=a||(a={})).Rear="REAR",y.Front="FRONT",a;var y})(),v=(()=>{return(y=v||(v={})).Uri="uri",y.Base64="base64",y.DataUrl="dataUrl",v;var y})()},6388:(Z,E,i)=>{i.d(E,{V1:()=>v,dk:()=>a.dk,oK:()=>a.oK});var s=i(7423),a=i(76);const v=(0,s.fo)("Camera",{web:()=>i.e(3954).then(i.bind(i,3954)).then(y=>new y.CameraWeb)})},1067:(Z,E,i)=>{i.d(E,{fy:()=>a});const a=(0,i(7423).fo)("Filesystem",{web:()=>i.e(6364).then(i.bind(i,6364)).then(v=>new v.FilesystemWeb)})},5641:(Z,E,i)=>{i.d(E,{f:()=>v});var s=i(4650);class v{onClick(){setTimeout(()=>{let e=null,h=document.getElementsByClassName("action-sheet-button");if(h.length>0){for(const C of h)if(C.classList.contains("action-sheet-selected")){e=C;break}}else{h=document.getElementsByClassName("alert-radio-button"),0===h.length&&(h=document.getElementsByClassName("sc-ion-select-popover"));for(const C of h){const A=C.attributes.getNamedItem("aria-checked");if(A&&"true"===A.value){e=C;break}}}e&&e.scrollIntoView({block:"center"})},250)}static \u0275fac=function(h){return new(h||v)};static \u0275dir=s.lG2({type:v,selectors:[["ion-select"]],hostBindings:function(h,C){1&h&&s.NdJ("click",function(){return C.onClick()})}})}},8349:(Z,E,i)=>{i.d(E,{n:()=>s});var s=(()=>{return(a=s||(s={}))[a.ACTIVE=1]="ACTIVE",a[a.DELETED=2]="DELETED",s;var a})()},5671:(Z,E,i)=>{i.d(E,{C:()=>s});var s=(()=>{return(a=s||(s={}))[a.PENDING=1]="PENDING",a[a.APPROVED=2]="APPROVED",a[a.PROCESSED=3]="PROCESSED",a[a.COMPLETED=4]="COMPLETED",a[a.DECLINED=5]="DECLINED",a[a.CANCELLED=6]="CANCELLED",s;var a})()},8791:(Z,E,i)=>{i.d(E,{R:()=>A});var s=i(1086),a=i(2868),v=i(7221),y=i(2340),e=i(4650),h=i(529),C=i(9709);class A{http;appconfig;constructor(f,t){this.http=f,this.appconfig=t}getByRervationId(f){return this.http.get(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.getByReservationId+f).pipe((0,a.b)(t=>this.log("order item")),(0,v.K)(this.handleError("order item",[])))}create(f){return this.http.post(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.create,f).pipe((0,a.b)(t=>this.log("order item")),(0,v.K)(this.handleError("order item",[])))}update(f){return this.http.put(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.update,f).pipe((0,a.b)(t=>this.log("order item")),(0,v.K)(this.handleError("order item",[])))}getById(f){return this.http.get(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.getById+f).pipe((0,a.b)(t=>this.log("order item")),(0,v.K)(this.handleError("order item",[])))}delete(f){return this.http.delete(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.delete+f).pipe((0,a.b)(t=>this.log("rder it")),(0,v.K)(this.handleError("rder it",[])))}addAttachmentFile(f){return this.http.post(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.addAttachmentFile,f).pipe((0,a.b)(t=>this.log("order item")),(0,v.K)(this.handleError("order item",[])))}removeAttachmentFile(f){return this.http.delete(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.removeAttachmentFile+f).pipe((0,a.b)(t=>this.log("rder it")),(0,v.K)(this.handleError("rder it",[])))}handleError(f="operation",t){return P=>(this.log(`${f} failed: ${Array.isArray(P.error.message)?P.error.message[0]:P.error.message}`),(0,s.of)(P.error))}log(f){console.log(f)}static \u0275fac=function(t){return new(t||A)(e.LFG(h.eN),e.LFG(C._))};static \u0275prov=e.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"})}},2669:(Z,E,i)=>{i.d(E,{D:()=>A});var s=i(1086),a=i(2868),v=i(7221),y=i(2340),e=i(4650),h=i(529),C=i(9709);class A{http;appconfig;constructor(f,t){this.http=f,this.appconfig=t}getByStatus(f){return this.http.get(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.getByStatus,{params:f}).pipe((0,a.b)(t=>this.log("reservation")),(0,v.K)(this.handleError("reservation",[])))}getById(f){return this.http.get(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.getById+f).pipe((0,a.b)(t=>this.log("reservation")),(0,v.K)(this.handleError("reservation",[])))}getReservationsForADay(f){return this.http.get(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.getReservationForADay+f).pipe((0,a.b)(t=>this.log("reservation")),(0,v.K)(this.handleError("reservation",[])))}createReservation(f){return this.http.post(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.createReservation,f).pipe((0,a.b)(t=>this.log("reservation")),(0,v.K)(this.handleError("reservation",[])))}rescheduleReservation(f){return this.http.put(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.rescheduleReservation,f).pipe((0,a.b)(t=>this.log("reservation")),(0,v.K)(this.handleError("reservation",[])))}updateReservationStatus(f){return this.http.put(y.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.updateReservationStatus,f).pipe((0,a.b)(t=>this.log("reservation")),(0,v.K)(this.handleError("reservation",[])))}handleError(f="operation",t){return P=>(this.log(`${f} failed: ${Array.isArray(P.error.message)?P.error.message[0]:P.error.message}`),(0,s.of)(P.error))}log(f){console.log(f)}static \u0275fac=function(t){return new(t||A)(e.LFG(h.eN),e.LFG(C._))};static \u0275prov=e.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"})}},7956:(Z,E,i)=>{i.d(E,{p:()=>e});var s=i(5861),a=i(4650),v=i(603);class y{message="Loading...";constructor(){}ngOnInit(){}static \u0275fac=function(A){return new(A||y)};static \u0275cmp=a.Xpm({type:y,selectors:[["app-page-loader"]],decls:5,vars:1,consts:[[1,"container"],[1,"holder"],["color","primary"]],template:function(A,L){1&A&&(a.TgZ(0,"div",0)(1,"div",1),a._UZ(2,"ion-spinner",2),a.TgZ(3,"span"),a._uU(4),a.qZA()()()),2&A&&(a.xp6(4),a.Oqu(L.message))},dependencies:[v.PQ],styles:[".container{height:100%;display:flex;align-items:center;flex-direction:column;justify-content:center}.container .holder{display:flex;align-items:center;gap:10px;flex-direction:column;font-size:20px;text-shadow:none!important}\n"],encapsulation:2})}class e{modalCtrl;modal;constructor(C){this.modalCtrl=C}open(C){var A=this;return(0,s.Z)(function*(){A.modal&&(yield A.modal.dismiss()),A.modal=yield A.modalCtrl.create({component:y,id:"page-loader",cssClass:"modal-fullscreen",canDismiss:!1,componentProps:{message:C}}),A.modal.present()})()}close(){var C=this;return(0,s.Z)(function*(){C.modal.canDismiss=!0,yield C.modal.dismiss()})()}static \u0275fac=function(A){return new(A||e)(a.LFG(v.IN))};static \u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}},8305:(Z,E,i)=>{i.d(E,{O:()=>_});var s=i(5861),a=i(8349),v=i(5671),y=i(8164),e=i(4650),h=i(603),C=i(7956),A=i(3746),L=i(8386),f=i(9709),t=i(8791),P=i(2669),D=i(6895);function M(c,m){if(1&c){const r=e.EpF();e.TgZ(0,"ion-item",23),e.NdJ("click",function(){e.CHM(r);const I=e.oxw(2);return e.KtG(I.onAddItem())}),e._UZ(1,"ion-icon",24),e.TgZ(2,"ion-label")(3,"h3",14),e._uU(4,"Add more item"),e.qZA()()()}}function S(c,m){if(1&c){const r=e.EpF();e.TgZ(0,"ion-icon",30),e.NdJ("click",function(){e.CHM(r);const I=e.oxw().$implicit,O=e.oxw(2);return e.KtG(O.details.orderItems.length>1?O.onRemoveItem(I.orderItemId):O.onCancelReservation())}),e.qZA()}}function x(c,m){if(1&c){const r=e.EpF();e.TgZ(0,"ion-item",25)(1,"ion-label",26),e.NdJ("click",function(){const O=e.CHM(r).$implicit,B=e.oxw(2);return e.KtG(B.onOpenItemDetails(O))}),e.TgZ(2,"h3",14),e._uU(3),e.qZA(),e.TgZ(4,"div",27)(5,"h2",28),e._uU(6),e.qZA()()(),e.YNc(7,S,1,0,"ion-icon",29),e.qZA()}if(2&c){const r=m.$implicit,u=e.oxw(2);e.xp6(3),e.AsE("x",r.quantity,"\xa0-\xa0",r.orderItemType.name,""),e.xp6(3),e.Oqu(r.remarks),e.xp6(1),e.Q6J("ngIf","1"===u.details.reservationStatus.reservationStatusId)}}function b(c,m){if(1&c&&(e.TgZ(0,"div",10)(1,"ion-item",11)(2,"ion-label",12)(3,"div",11)(4,"h2",13)(5,"strong"),e._uU(6),e.qZA()()()()(),e.TgZ(7,"ion-item",11)(8,"ion-label",12)(9,"h3",14)(10,"strong")(11,"ion-text",15),e._uU(12),e.qZA()()(),e.TgZ(13,"h3",16),e._uU(14,"Status"),e.qZA()()(),e.TgZ(15,"ion-item",11),e._UZ(16,"ion-icon",17),e.TgZ(17,"ion-label",12)(18,"h3",14),e._uU(19),e.qZA()()(),e.TgZ(20,"ion-item",11),e._UZ(21,"ion-icon",18),e.TgZ(22,"ion-label",12)(23,"h3",14),e._uU(24),e.ALo(25,"date"),e.qZA()()(),e.TgZ(26,"ion-item",11),e._UZ(27,"ion-icon",19),e.TgZ(28,"ion-label",12)(29,"h2",13),e._uU(30),e.qZA(),e.TgZ(31,"span",16),e._uU(32),e.qZA()()(),e.TgZ(33,"ion-item",11)(34,"ion-label",12)(35,"h2",14)(36,"strong"),e._uU(37,"Items"),e.qZA()()()(),e.YNc(38,M,5,0,"ion-item",20),e.TgZ(39,"ion-list",21),e.YNc(40,x,8,4,"ion-item",22),e.qZA()()),2&c){const r=e.oxw();let u;e.xp6(6),e.Oqu(r.details.reservationCode),e.xp6(5),e.Q6J("color",("1"===r.details.reservationStatus.reservationStatusId||"4"===r.details.reservationStatus.reservationStatusId?"danger":"")||("2"===r.details.reservationStatus.reservationStatusId?"primary":"")||(null!==(u="3"===r.details.reservationStatus.reservationStatusId)&&void 0!==u?u:"tertiary")),e.xp6(1),e.hij(" ",r.details.reservationStatus.name," "),e.xp6(7),e.Oqu(r.details.reservationLevel.name),e.xp6(5),e.Oqu(e.xi3(25,10,r.details.reqCompletionDate,"MMMM dd, YYYY")),e.xp6(6),e.Oqu(r.details.description),e.xp6(2),e.Oqu(""!==r.details.description?"Remarks":"No Remarks"),e.xp6(6),e.Q6J("ngIf","1"===r.details.reservationStatus.reservationStatusId),e.xp6(1),e.Q6J("lines",r.details.orderItems.length>1?"":"none"),e.xp6(1),e.Q6J("ngForOf",r.details.orderItems)}}function g(c,m){1&c&&(e.TgZ(0,"div",10)(1,"ion-item",11)(2,"ion-label",12)(3,"h3",14)(4,"strong")(5,"ion-text"),e._UZ(6,"ion-skeleton-text",31),e.qZA()()(),e.TgZ(7,"h3",16),e._UZ(8,"ion-skeleton-text",31),e.qZA()()(),e.TgZ(9,"ion-item",11)(10,"ion-label",12)(11,"div",32)(12,"h1",13),e._UZ(13,"ion-skeleton-text",31),e.qZA(),e.TgZ(14,"h3",14),e._UZ(15,"ion-skeleton-text",31),e.qZA()()()(),e.TgZ(16,"ion-item",11),e._UZ(17,"ion-icon",18),e.TgZ(18,"ion-label",12)(19,"h3",14),e._UZ(20,"ion-skeleton-text",31),e.qZA(),e.TgZ(21,"h3",14),e._UZ(22,"ion-skeleton-text",31),e.qZA()()()()),2&c&&(e.xp6(6),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(5),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(5),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0))}function l(c,m){if(1&c){const r=e.EpF();e.TgZ(0,"ion-button",33),e.NdJ("click",function(){e.CHM(r);const I=e.oxw();return e.KtG(I.onCancelReservation())}),e._uU(1,"Cancel reservation"),e.qZA()}if(2&c){const r=e.oxw();e.Q6J("disabled",r.isLoading)}}class _{modalCtrl;alertController;actionSheetController;platform;pageLoaderService;storageService;userService;appconfig;orderItemService;reservationService;hasChanges=!1;currentUser;isLoading=!1;details={};constructor(m,r,u,I,O,B,N,K,k,R){this.modalCtrl=m,this.alertController=r,this.actionSheetController=u,this.platform=I,this.pageLoaderService=O,this.storageService=B,this.userService=N,this.appconfig=K,this.orderItemService=k,this.reservationService=R,this.platform.backButton.subscribeWithPriority(-1,()=>{this.cancel()})}ngOnInit(){this.getReservation(this.details.reservationId)}getReservation(m){var r=this;return(0,s.Z)(function*(){try{r.isLoading=!0,r.reservationService.getById(m).subscribe(function(){var u=(0,s.Z)(function*(I){I.success?(r.details=I.data,r.details.orderItems=I.data.orderItems.filter(O=>O.entityStatus.entityStatusId===a.n.ACTIVE.toString()),r.isLoading=!1):yield r.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(I.message)?I.message[0]:I.message,buttons:["OK"]})});return function(I){return u.apply(this,arguments)}}(),function(){var u=(0,s.Z)(function*(I){yield r.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(I.message)?I.message[0]:I.message,buttons:["OK"]}),r.isLoading=!1});return function(I){return u.apply(this,arguments)}}())}catch(u){r.isLoading=!1,yield r.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(u.message)?u.message[0]:u.message,buttons:["OK"]})}})()}onAddItem(){var m=this;return(0,s.Z)(function*(){const r=yield m.modalCtrl.create({component:y.Q,cssClass:"modal-fullscreen",componentProps:{reservation:m.details,canEdit:!0,currentUser:m.currentUser}});r.present(),yield r.onWillDismiss().then(function(){var u=(0,s.Z)(function*(I){I.data&&(yield m.getReservation(m.details.reservationId))});return function(I){return u.apply(this,arguments)}}())})()}onOpenItemDetails(m){var r=this;return(0,s.Z)(function*(){const u=yield r.modalCtrl.create({component:y.Q,cssClass:"modal-fullscreen",componentProps:{details:m,reservation:r.details,canEdit:r.details.reservationStatus.reservationStatusId===v.C.PENDING.toString(),currentUser:r.currentUser}});u.present();const{role:O}=yield u.onWillDismiss();"confirm"===O&&(yield r.getReservation(r.details.reservationId))})()}onRemoveItem(m){var r=this;return(0,s.Z)(function*(){try{yield r.presentAlert({header:"Are you sure you want to remove this item?",buttons:[{text:"CANCEL",role:"cancel"},{text:"YES Continue",role:"confirm",handler:(u=(0,s.Z)(function*(){yield r.pageLoaderService.open("Processing please wait..."),r.isLoading=!0,r.orderItemService.delete(m).subscribe(function(){var I=(0,s.Z)(function*(O){O.success?(yield r.pageLoaderService.close(),yield r.presentAlert({header:"Item deleted!",buttons:["OK"]}),r.isLoading=!1,yield r.pageLoaderService.close(),yield r.getReservation(r.details.reservationId)):(yield r.pageLoaderService.close(),r.isLoading=!1,yield r.presentAlert({header:"Try again!",message:Array.isArray(O.message)?O.message[0]:O.message,buttons:["OK"]}))});return function(O){return I.apply(this,arguments)}}(),function(){var I=(0,s.Z)(function*(O){yield r.pageLoaderService.close(),r.isLoading=!1,yield r.presentAlert({header:"Try again!",message:Array.isArray(O.message)?O.message[0]:O.message,buttons:["OK"]})});return function(O){return I.apply(this,arguments)}}())}),function(){return u.apply(this,arguments)})}]})}catch(u){yield r.pageLoaderService.close(),r.isLoading=!1,yield r.presentAlert({header:"Try again!",message:Array.isArray(u.message)?u.message[0]:u.message,buttons:["OK"]})}var u})()}onCancelReservation(){var m=this;return(0,s.Z)(function*(){var r;yield m.presentAlert({header:"Are you sure you want to cancel reservation?",buttons:[{text:"BACK",role:"cancel"},{text:"YES",role:"confirm",handler:(r=(0,s.Z)(function*(){m.cancelReservation()}),function(){return r.apply(this,arguments)})}]})})()}cancelReservation(){var m=this;return(0,s.Z)(function*(){try{yield m.pageLoaderService.open("Processing please wait..."),m.isLoading=!0,m.reservationService.updateReservationStatus({reservationId:m.details.reservationId,reservationStatusId:v.C.CANCELLED}).subscribe(function(){var r=(0,s.Z)(function*(u){if(u.success)return m.hasChanges=!0,yield m.pageLoaderService.close(),yield m.presentAlert({header:"Reservation cancelled!",buttons:["OK"]}),m.isLoading=!1,m.modalCtrl.dismiss(!0,"confirm");yield m.pageLoaderService.close(),m.isLoading=!1,yield m.presentAlert({header:"Try again!",message:Array.isArray(u.message)?u.message[0]:u.message,buttons:["OK"]})});return function(u){return r.apply(this,arguments)}}(),function(){var r=(0,s.Z)(function*(u){yield m.pageLoaderService.close(),m.isLoading=!1,yield m.presentAlert({header:"Try again!",message:Array.isArray(u.message)?u.message[0]:u.message,buttons:["OK"]})});return function(u){return r.apply(this,arguments)}}())}catch(r){yield m.pageLoaderService.close(),m.isLoading=!1,yield m.presentAlert({header:"Try again!",message:Array.isArray(r.message)?r.message[0]:r.message,buttons:["OK"]})}})()}cancel(){return this.modalCtrl.dismiss(this.hasChanges?this.hasChanges:null,"cancel")}presentAlert(m){var r=this;return(0,s.Z)(function*(){yield(yield r.alertController.create(m)).present()})()}static \u0275fac=function(r){return new(r||_)(e.Y36(h.IN),e.Y36(h.Br),e.Y36(h.BX),e.Y36(h.t4),e.Y36(C.p),e.Y36(A.V),e.Y36(L.K),e.Y36(f._),e.Y36(t.R),e.Y36(P.D))};static \u0275cmp=e.Xpm({type:_,selectors:[["app-booking-details"]],decls:14,vars:4,consts:[["slot","start"],[3,"disabled","click"],["name","chevron-back"],[2,"text-align","center"],["slot","end",2,"width","48px"],[1,"ion-padding"],["class","details-container",4,"ngIf","ngIfElse"],["loading",""],[1,"sched-controls-bottom"],["color","danger","expand","block","fill","outline",3,"disabled","click",4,"ngIf"],[1,"details-container"],[1,"item"],["text-wrap",""],[1,"title"],[1,"sub"],[3,"color"],[1,"desc"],["name","alert-circle","slot","start"],["name","today","slot","start"],["name","pricetag","slot","start"],["button","","class","ion-no-padding","detail","false",3,"click",4,"ngIf"],[3,"lines"],["button","","detail","false","class","item",4,"ngFor","ngForOf"],["button","","detail","false",1,"ion-no-padding",3,"click"],["name","add-outline"],["button","","detail","false",1,"item"],[3,"click"],[1,"attribute"],[1,"remarks","sub"],["name","trash-outline",3,"click",4,"ngIf"],["name","trash-outline",3,"click"],[3,"animated"],[1,"item","type"],["color","danger","expand","block","fill","outline",3,"disabled","click"]],template:function(r,u){if(1&r&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return u.cancel()}),e._UZ(4,"ion-icon",2),e.qZA()(),e.TgZ(5,"ion-title",3),e._uU(6,"Details"),e.qZA(),e._UZ(7,"div",4),e.qZA()(),e.TgZ(8,"ion-content",5),e.YNc(9,b,41,13,"div",6),e.YNc(10,g,23,6,"ng-template",null,7,e.W1O),e.qZA(),e.TgZ(12,"div",8),e.YNc(13,l,2,1,"ion-button",9),e.qZA()),2&r){const I=e.MAs(11);e.xp6(3),e.Q6J("disabled",u.isLoading),e.xp6(6),e.Q6J("ngIf",!u.isLoading)("ngIfElse",I),e.xp6(4),e.Q6J("ngIf",!u.isLoading&&"1"===u.details.reservationStatus.reservationStatusId)}},dependencies:[D.sg,D.O5,h.YG,h.Sm,h.W2,h.Gu,h.gu,h.Ie,h.Q$,h.q_,h.CK,h.yW,h.wd,h.sr,D.uU],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}.message-header-button[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{position:absolute;z-index:9;top:0;right:-10px;font-size:12px}.video-conference-button.disabled[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#0003!important}.video-conference-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#26a69a}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{color:#000!important;display:flex;flex-direction:column}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{margin:5px 0!important}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]{color:#999!important}.details-container[_ngcontent-%COMP%]   .item.type[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:500}.sched-controls-bottom[_ngcontent-%COMP%]{position:relative;display:block;width:100%;background:#ffffff;padding:5px 10px;box-shadow:0 3px 10px #0003}.sched-controls-bottom[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:45px;font-size:15px}.photos[_ngcontent-%COMP%]{row-gap:10px;display:flex;flex-direction:column;box-sizing:border-box;width:100%;padding:10px}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:auto}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:200px;border-radius:10px;object-position:center;object-fit:contain;box-shadow:0 0 10px #7a7a7a75}"]})}},8164:(Z,E,i)=>{i.d(E,{Q:()=>U});var s=i(5861),a=i(4006),v=i(567);class C{orderItemId;quantity;remarks;orderItemType;reservation;entityStatus;orderItemAttachments}var L=i(8305),f=i(2531),t=i(4650),P=i(603),D=i(7956),M=i(3746),S=i(8386),x=i(9709),b=i(8791),g=i(1086),l=i(2868),_=i(7221),c=i(2340),m=i(529);class r{http;appconfig;constructor(n,d){this.http=n,this.appconfig=d}getAll(){return this.http.get(c.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItemType.getAll).pipe((0,l.b)(n=>this.log("order item type")),(0,_.K)(this.handleError("order item type",[])))}handleError(n="operation",d){return o=>(this.log(`${n} failed: ${Array.isArray(o.error.message)?o.error.message[0]:o.error.message}`),(0,g.of)(o.error))}log(n){console.log(n)}static \u0275fac=function(d){return new(d||r)(t.LFG(m.eN),t.LFG(x._))};static \u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}var u=i(6895),I=i(9549),O=i(4144),B=i(5641);function N(T,n){if(1&T){const d=t.EpF();t.TgZ(0,"ion-buttons",18)(1,"ion-button",1),t.NdJ("click",function(){t.CHM(d);const p=t.oxw();return t.KtG(p.onSubmit())}),t._UZ(2,"ion-icon",19),t.qZA()()}if(2&T){const d=t.oxw();t.xp6(1),t.Q6J("disabled",d.isLoading||!d.itemForm.valid)}}function K(T,n){1&T&&t._UZ(0,"div",20)}function k(T,n){if(1&T){const d=t.EpF();t.TgZ(0,"ion-list")(1,"ion-item",21),t.NdJ("click",function(){t.CHM(d);const p=t.oxw();return t.KtG(p.onOpenDetails())}),t.TgZ(2,"ion-label")(3,"div")(4,"h3")(5,"strong"),t._uU(6),t.TgZ(7,"ion-text",22),t._uU(8),t.qZA()()()()()()()}if(2&T){const d=t.oxw();let o;t.xp6(6),t.hij("ID ",d.reservation?d.reservation.reservationCode:""," "),t.xp6(1),t.Q6J("color",("1"===d.reservation.reservationStatus.reservationStatusId||"4"===d.reservation.reservationStatus.reservationStatusId?"danger":"")||("2"===d.reservation.reservationStatus.reservationStatusId?"primary":"")||(null!==(o="3"===d.reservation.reservationStatus.reservationStatusId)&&void 0!==o?o:"tertiary")),t.xp6(1),t.hij(" ",d.reservation.reservationStatus.name," ")}}function R(T,n){if(1&T&&(t.TgZ(0,"ion-select-option",26),t._uU(1),t.qZA()),2&T){const d=n.$implicit;t.s9C("value",d.orderItemTypeId.toString()),t.xp6(1),t.Oqu(d.name)}}function F(T,n){if(1&T&&(t.TgZ(0,"ion-item",23)(1,"ion-select",24),t.YNc(2,R,2,2,"ion-select-option",25),t.qZA()()),2&T){const d=t.oxw();t.Q6J("disabled",d.isLoading),t.xp6(2),t.Q6J("ngForOf",d.orderItemTypeOption)}}function Y(T,n){if(1&T&&(t.TgZ(0,"ion-radio-group")(1,"ion-item",27)(2,"ion-label"),t._uU(3),t.qZA()()()),2&T){const d=t.oxw();t.xp6(3),t.Oqu(d.details.orderItemType.name)}}function W(T,n){1&T&&(t.TgZ(0,"span",28),t._uU(1," Please select a type of item "),t.qZA())}class U{modalCtrl;alertController;actionSheetController;platform;formBuilder;pageLoaderService;storageService;userService;appconfig;orderItemService;orderItemTypeService;modal;canEdit=!1;hasChanges=!1;currentUser;isLoading=!1;isSubmitting=!1;isLoadingFilter=!1;details;reservation;orderItemTypeOption=[];itemForm;orderItemAttachments=[];constructor(n,d,o,p,J,w,Q,G,H,$,q){this.modalCtrl=n,this.alertController=d,this.actionSheetController=o,this.platform=p,this.formBuilder=J,this.pageLoaderService=w,this.storageService=Q,this.userService=G,this.appconfig=H,this.orderItemService=$,this.orderItemTypeService=q,this.platform.backButton.subscribeWithPriority(-1,()=>{this.cancel()})}get isNew(){return!this.details||!this.details.orderItemId||""===this.details.orderItemId}get formData(){return{...this.itemForm.value,orderItemId:this.isNew?null:this.details.orderItemId,reservationId:this.reservation?this.reservation.reservationId:null,orderItemAttachments:this.orderItemAttachments}}get errorControls(){return this.itemForm.controls}initFilter(){var n=this;this.isLoadingFilter=!0,(0,v.D)([this.orderItemTypeService.getAll()]).subscribe(([d])=>{this.orderItemTypeOption=d.data},d=>console.error(d),(0,s.Z)(function*(){n.isLoadingFilter=!1,n.details&&n.details.orderItemId?(yield n.getOrderItem(n.details.orderItemId),n.itemForm.controls.quantity.setValue(n.details.quantity),n.itemForm.controls.remarks.setValue(n.details.remarks)):n.details&&(n.itemForm.controls.orderItemTypeId.setValue(n.details.orderItemType.orderItemTypeId),n.itemForm.controls.quantity.setValue(n.details.quantity),n.itemForm.controls.remarks.setValue(n.details.remarks))}))}ngOnInit(){this.itemForm=new a.cw({orderItemTypeId:new a.NI(null,a.kI.required),quantity:new a.NI(null,[a.kI.required,a.kI.min(1)]),remarks:new a.NI(null,a.kI.required)}),this.initFilter()}getOrderItem(n){var d=this;return(0,s.Z)(function*(){try{d.isLoading=!0,d.orderItemService.getById(n).subscribe(function(){var o=(0,s.Z)(function*(p){p.success?(d.details={...p.data,...d.details},d.isLoading=!1,d.itemForm.controls.orderItemTypeId.setValue(p.data.orderItemType.orderItemTypeId),d.orderItemAttachments=d.details.orderItemAttachments):yield d.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(p.message)?p.message[0]:p.message,buttons:["OK"]})});return function(p){return o.apply(this,arguments)}}(),function(){var o=(0,s.Z)(function*(p){yield d.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(p.message)?p.message[0]:p.message,buttons:["OK"]}),d.isLoading=!1});return function(p){return o.apply(this,arguments)}}())}catch(o){yield d.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(o.message)?o.message[0]:o.message,buttons:["OK"]})}})()}onSubmit(){var n=this;return(0,s.Z)(function*(){const d=n.formData;try{if(n.isSubmitting=!0,n.isNew)if(n.reservation&&""!==n.reservation.reservationId)yield n.pageLoaderService.open("Saving item..."),n.orderItemService.create(d).subscribe(function(){var o=(0,s.Z)(function*(p){p.success?(yield n.presentAlert({header:"Saved!",buttons:["OK"]}),n.isSubmitting=!1,n.modal.canDismiss=!0,n.modal.dismiss({success:!0,data:p.data},"confirm"),yield n.pageLoaderService.close()):(yield n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(p.message)?p.message[0]:p.message,buttons:["OK"]}))});return function(p){return o.apply(this,arguments)}}(),function(){var o=(0,s.Z)(function*(p){yield n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(p.message)?p.message[0]:p.message,buttons:["OK"]})});return function(p){return o.apply(this,arguments)}}());else{const o=new C;o.quantity=n.formData.quantity,o.orderItemType=n.orderItemTypeOption.filter(p=>p.orderItemTypeId===n.formData.orderItemTypeId)[0],o.remarks=n.formData.remarks,o.orderItemAttachments=n.formData.orderItemAttachments,n.modal.dismiss({success:!0,data:o},"confirm")}else if(n.details&&n.details.reservation&&""!==n.details.reservation.reservationId)yield n.pageLoaderService.open("Saving item..."),n.orderItemService.update(d).subscribe(function(){var o=(0,s.Z)(function*(p){p.success?(yield n.presentAlert({header:"Saved!",buttons:["OK"]}),n.isSubmitting=!1,n.modal.canDismiss=!0,n.modal.dismiss({success:!0,data:p.data},"confirm"),yield n.pageLoaderService.close()):(yield n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(p.message)?p.message[0]:p.message,buttons:["OK"]}))});return function(p){return o.apply(this,arguments)}}(),function(){var o=(0,s.Z)(function*(p){yield n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(p.message)?p.message[0]:p.message,buttons:["OK"]})});return function(p){return o.apply(this,arguments)}}());else{const o=new C;o.quantity=n.formData.quantity,o.orderItemType=n.orderItemTypeOption.filter(p=>p.orderItemTypeId===n.formData.orderItemTypeId)[0],o.remarks=n.formData.remarks,n.modal.dismiss({success:!0,data:o},"confirm")}}catch(o){yield n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(o.message)?o.message[0]:o.message,buttons:["OK"]})}})()}delete(){var n=this;return(0,s.Z)(function*(){try{yield n.pageLoaderService.open("Processing please wait..."),n.isLoading=!0,n.orderItemService.delete(n.details.orderItemId).subscribe(function(){var d=(0,s.Z)(function*(o){if(o.success)return n.hasChanges=!0,yield n.pageLoaderService.close(),yield n.presentAlert({header:"Item deleted!",buttons:["OK"]}),n.isLoading=!1,n.modalCtrl.dismiss(!0,"confirm");yield n.pageLoaderService.close(),n.isLoading=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(o.message)?o.message[0]:o.message,buttons:["OK"]})});return function(o){return d.apply(this,arguments)}}(),function(){var d=(0,s.Z)(function*(o){yield n.pageLoaderService.close(),n.isLoading=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(o.message)?o.message[0]:o.message,buttons:["OK"]})});return function(o){return d.apply(this,arguments)}}())}catch(d){yield n.pageLoaderService.close(),n.isLoading=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]})}})()}onOpenDetails(){var n=this;return(0,s.Z)(function*(){n.modalCtrl.dismiss();const d=yield n.modalCtrl.create({component:L.O,cssClass:"modal-fullscreen",componentProps:{details:n.reservation,currentUser:n.currentUser}});d.present(),yield d.onWillDismiss()})()}openAttachment(){var n=this;return(0,s.Z)(function*(){const d=yield n.modalCtrl.create({component:f.n,cssClass:"modal-fullscreen",componentProps:{isNew:n.isNew,currentUser:n.currentUser,orderItemAttachments:n.orderItemAttachments&&n.orderItemAttachments.length>0?n.orderItemAttachments.sort((o,p)=>Number(p.orderItemAttachmentId)-Number(o.orderItemAttachmentId)):[],orderItemId:n.details&&n.details.orderItemId?n.details.orderItemId:null}});d.present(),yield d.onWillDismiss().then(function(){var o=(0,s.Z)(function*(p){p.data&&(n.orderItemAttachments=p.data)});return function(p){return o.apply(this,arguments)}}())})()}cancel(){return this.modalCtrl.dismiss(this.hasChanges?this.hasChanges:null,"cancel")}presentAlert(n){var d=this;return(0,s.Z)(function*(){yield(yield d.alertController.create(n)).present()})()}static \u0275fac=function(d){return new(d||U)(t.Y36(P.IN),t.Y36(P.Br),t.Y36(P.BX),t.Y36(P.t4),t.Y36(a.qu),t.Y36(D.p),t.Y36(M.V),t.Y36(S.K),t.Y36(x._),t.Y36(b.R),t.Y36(r))};static \u0275cmp=t.Xpm({type:U,selectors:[["app-booking-item-add"]],decls:34,vars:12,consts:[["slot","start"],[3,"disabled","click"],["name","chevron-back"],[2,"text-align","center"],["slot","end",4,"ngIf"],["slot","end","style","width: 48px",4,"ngIf"],[1,"ion-padding"],["id","itemForm",3,"formGroup","ngSubmit"],[4,"ngIf"],[1,"form-field-group"],["fill","outline",3,"disabled",4,"ngIf"],["class","error",4,"ngIf"],["appearance","outline"],["matInput","","type","number","placeholder","Quantity","formControlName","quantity","autocomplete","new-quantity",3,"readonly"],["matInput","","type","text","placeholder","Remarks","formControlName","remarks","autocomplete","new-quantity",2,"height","200px",3,"readonly"],["lines","full"],["button","","detail","true",3,"click"],["slot","icon-only","name","chevron-forward-outline"],["slot","end"],["name","checkmark-outline"],["slot","end",2,"width","48px"],["lines","none","button","","detail","true",3,"click"],[3,"color"],["fill","outline",3,"disabled"],["slot","start","formControlName","orderItemTypeId","placeholder","Select type"],["slot","start",3,"value",4,"ngFor","ngForOf"],["slot","start",3,"value"],["fill","outline","lines","none"],[1,"error"]],template:function(d,o){1&d&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.cancel()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-title",3),t._uU(6),t.qZA(),t.YNc(7,N,3,1,"ion-buttons",4),t.YNc(8,K,1,0,"div",5),t.qZA()(),t.TgZ(9,"ion-content",6)(10,"form",7),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(11,"fieldset"),t.YNc(12,k,9,3,"ion-list",8),t.TgZ(13,"div",9)(14,"mat-label",0),t._uU(15,"What type of item"),t.qZA(),t.YNc(16,F,3,2,"ion-item",10),t.YNc(17,Y,4,1,"ion-radio-group",8),t.YNc(18,W,2,0,"span",11),t.qZA(),t.TgZ(19,"div",9)(20,"mat-form-field",12)(21,"mat-label"),t._uU(22,"Quantity"),t.qZA(),t._UZ(23,"input",13),t.qZA()(),t.TgZ(24,"div",9)(25,"mat-form-field",12)(26,"mat-label"),t._uU(27,"Remarks"),t.qZA(),t._UZ(28,"textarea",14),t.qZA()()()(),t.TgZ(29,"ion-list",15)(30,"ion-item",16),t.NdJ("click",function(){return o.openAttachment()}),t.TgZ(31,"ion-label"),t._uU(32),t.qZA(),t._UZ(33,"ion-icon",17),t.qZA()()()),2&d&&(t.xp6(3),t.Q6J("disabled",o.isLoading),t.xp6(3),t.Oqu(o.isLoading?"":o.isNew?"New item":o.canEdit?"Edit item":"Details"),t.xp6(1),t.Q6J("ngIf",o.canEdit),t.xp6(1),t.Q6J("ngIf",!o.canEdit),t.xp6(2),t.Q6J("formGroup",o.itemForm),t.xp6(2),t.Q6J("ngIf",!o.isLoading&&(o.reservation&&!o.isNew||o.reservation&&o.isNew)),t.xp6(4),t.Q6J("ngIf",o.canEdit),t.xp6(1),t.Q6J("ngIf",!o.canEdit),t.xp6(1),t.Q6J("ngIf",o.errorControls.orderItemTypeId.touched&&o.errorControls.orderItemTypeId.errors&&o.errorControls.orderItemTypeId.errors.required),t.xp6(5),t.Q6J("readonly",!o.canEdit),t.xp6(5),t.Q6J("readonly",!o.canEdit),t.xp6(4),t.hij("Attachments(",o.orderItemAttachments?o.orderItemAttachments.length:0,")"))},dependencies:[u.sg,u.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.sg,a.u,P.YG,P.Sm,P.W2,P.Gu,P.gu,P.Ie,P.Q$,P.q_,P.se,P.t9,P.n0,P.yW,P.wd,P.sr,P.QI,I.KE,I.hX,O.Nt,B.f],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}"]})}},2531:(Z,E,i)=>{i.d(E,{n:()=>x});var s=i(5861),a=i(6388),v=i(1067),y=i(5794),e=i(4650),h=i(603),C=i(7956),A=i(8791),L=i(6895),f=i(6351);function t(b,g){if(1&b){const l=e.EpF();e.TgZ(0,"ion-button",1),e.NdJ("click",function(){e.CHM(l);const c=e.oxw();return e.KtG(c.done())}),e._UZ(1,"ion-icon",12),e.qZA()}}function P(b,g){1&b&&e._UZ(0,"div",13)}function D(b,g){if(1&b){const l=e.EpF();e.TgZ(0,"ion-avatar")(1,"ion-fab-button",16),e.NdJ("click",function(){const m=e.CHM(l).$implicit,r=e.oxw(2);return e.KtG(r.onRemovePhoto(m))}),e._UZ(2,"ion-icon",17),e.qZA(),e.TgZ(3,"ion-img-viewer",18),e.NdJ("error",function(c){e.CHM(l);const m=e.oxw(2);return e.KtG(m.imageErrorHandler(c))}),e.qZA()()}if(2&b){const l=g.$implicit,_=e.oxw(2);e.xp6(3),e.Q6J("src",_.isNew||l.isNew?l?l.url:"":l.file?l.file.url:"")}}function M(b,g){if(1&b&&(e.TgZ(0,"div",14),e.YNc(1,D,4,1,"ion-avatar",15),e.qZA()),2&b){const l=e.oxw();e.xp6(1),e.Q6J("ngForOf",l.orderItemAttachments)}}function S(b,g){1&b&&(e.TgZ(0,"div",19),e._UZ(1,"ion-icon",20),e.TgZ(2,"h3",21),e._uU(3,"No attachments to show"),e.qZA()())}class x{modalCtrl;platform;alertController;pageLoaderService;orderItemService;actionSheetController;isNew=!1;modal;orderItemAttachments=[];isLoading=!1;orderItemId;constructor(g,l,_,c,m,r){this.modalCtrl=g,this.platform=l,this.alertController=_,this.pageLoaderService=c,this.orderItemService=m,this.actionSheetController=r}ngOnInit(){}onAddPhoto(){var g=this;return(0,s.Z)(function*(){const l=yield g.actionSheetController.create({cssClass:"sched-card-action-sheet",buttons:[{text:"Camera",handler:(_=(0,s.Z)(function*(){const c=yield a.V1.getPhoto({quality:90,allowEditing:!1,resultType:a.dk.Uri,source:a.oK.Camera});if(c){const m=yield g.readAsBase64(c),u={id:g.orderItemAttachments.length>0?g.orderItemAttachments[g.orderItemAttachments.length-1]:1,fileName:`profile-sample-name.${c.format}`,data:m,url:`data:image/${c.format};base64,${m}`,isNew:!0};g.orderItemId&&""!==g.orderItemId?yield g.saveAttachments(u):g.orderItemAttachments=[u,...g.orderItemAttachments]}l.dismiss()}),function(){return _.apply(this,arguments)})},{text:"Gallery",handler:function(){var _=(0,s.Z)(function*(){const c=yield a.V1.getPhoto({quality:90,allowEditing:!1,resultType:a.dk.Uri,source:a.oK.Photos});if(c){const m=yield g.readAsBase64(c),u={id:g.orderItemAttachments.length>0?g.orderItemAttachments[g.orderItemAttachments.length-1]:1,fileName:`profile-sample-name.${c.format}`,data:m,url:`data:image/${c.format};base64,${m}`,isNew:!0};g.orderItemId&&""!==g.orderItemId?yield g.saveAttachments(u):g.orderItemAttachments=[u,...g.orderItemAttachments]}l.dismiss()});return function(){return _.apply(this,arguments)}}()},{text:"Cancel",handler:function(){var _=(0,s.Z)(function*(){l.dismiss()});return function(){return _.apply(this,arguments)}}()}]});var _;yield l.present()})()}onRemovePhoto(g){var l=this;return(0,s.Z)(function*(){var _;g.isNew?l.orderItemAttachments=l.orderItemAttachments.filter(_=>_.id!==g.id):yield l.presentAlert({header:"Are you sure you want to remove this attachment?",buttons:[{text:"CANCEL",role:"cancel"},{text:"YES Continue",role:"confirm",handler:(_=(0,s.Z)(function*(){yield l.removePhoto(g)}),function(){return _.apply(this,arguments)})}]})})()}removePhoto(g){var l=this;return(0,s.Z)(function*(){try{yield l.pageLoaderService.open("Processing please wait..."),l.isLoading=!0,l.orderItemService.removeAttachmentFile(g.orderItemAttachmentId).subscribe(function(){var _=(0,s.Z)(function*(c){c.success?(yield l.pageLoaderService.close(),yield l.presentAlert({header:"Removed!",buttons:["OK"]}),l.isLoading=!1,l.orderItemAttachments=c.data.sort((m,r)=>Number(r.orderItemAttachmentId)-Number(m.orderItemAttachmentId))):(yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(c.message)?c.message[0]:c.message,buttons:["OK"]}))});return function(c){return _.apply(this,arguments)}}(),function(){var _=(0,s.Z)(function*(c){yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(c.message)?c.message[0]:c.message,buttons:["OK"]})});return function(c){return _.apply(this,arguments)}}())}catch(_){yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(_.message)?_.message[0]:_.message,buttons:["OK"]})}})()}done(){var g=this;return(0,s.Z)(function*(){g.modal.canDismiss=!0,g.modalCtrl.dismiss(g.orderItemAttachments,"done")})()}saveAttachments(g){var l=this;return(0,s.Z)(function*(){g={...g,orderItemId:l.orderItemId};try{l.isLoading=!0,yield l.pageLoaderService.open("Saving attachment..."),l.orderItemService.addAttachmentFile(g).subscribe(function(){var _=(0,s.Z)(function*(c){c.success?(yield l.presentAlert({header:"Saved!",buttons:["OK"]}),l.isLoading=!1,l.orderItemAttachments=c.data.sort((m,r)=>Number(r.orderItemAttachmentId)-Number(m.orderItemAttachmentId)),yield l.pageLoaderService.close()):(yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(c.message)?c.message[0]:c.message,buttons:["OK"]}))});return function(c){return _.apply(this,arguments)}}(),function(){var _=(0,s.Z)(function*(c){yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(c.message)?c.message[0]:c.message,buttons:["OK"]})});return function(c){return _.apply(this,arguments)}}())}catch(_){yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(_.message)?_.message[0]:_.message,buttons:["OK"]})}})()}readAsBase64(g){var l=this;return(0,s.Z)(function*(){if(l.platform.is("hybrid"))return(yield v.fy.readFile({path:g.path})).data;{const c=yield(yield fetch(g.webPath)).blob();return(yield l.convertBlobToBase64(c)).split(",")[1]}})()}convertBlobToBase64=g=>new Promise((l,_)=>{const c=new FileReader;c.onerror=_,c.onload=()=>{l(c.result)},c.readAsDataURL(g)});imageErrorHandler(g){return(0,s.Z)(function*(){g.target.src="../../../../assets/img/error_black.png"})()}onViewImage(g){var l=this;return(0,s.Z)(function*(){if(g&&g.source){const _=yield l.modalCtrl.create({component:y.r,cssClass:"modal-fullscreen",componentProps:{file:{url:g.source}}});_.present(),yield _.onWillDismiss()}})()}cancel(){this.modal.canDismiss=!0,this.modalCtrl.dismiss(this.orderItemAttachments,"cancel")}presentAlert(g){var l=this;return(0,s.Z)(function*(){yield(yield l.alertController.create(g)).present()})()}static \u0275fac=function(l){return new(l||x)(e.Y36(h.IN),e.Y36(h.t4),e.Y36(h.Br),e.Y36(C.p),e.Y36(A.R),e.Y36(h.BX))};static \u0275cmp=e.Xpm({type:x,selectors:[["app-booking-item-attachments"]],decls:17,vars:4,consts:[["slot","start"],[3,"click"],["name","chevron-back"],[2,"text-align","center"],["slot","end"],[3,"click",4,"ngIf"],["slot","end","style","width: 48px",4,"ngIf"],[1,"ion-padding"],["slot","fixed","vertical","bottom","horizontal","end"],["name","image-outline"],["class","photos",4,"ngIf","ngIfElse"],["elseNoRecords",""],["name","checkmark-outline"],["slot","end",2,"width","48px"],[1,"photos"],[4,"ngFor","ngForOf"],["size","small","color","danger",1,"remove-button",3,"click"],["name","close"],["scheme","dark",3,"src","error"],[1,"no-records"],["name","images-outline",2,"font-size","4em"],[1,"text"]],template:function(l,_){if(1&l&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return _.cancel()}),e._UZ(4,"ion-icon",2),e.qZA()(),e.TgZ(5,"ion-title",3),e._uU(6,"Attachments"),e.qZA(),e.TgZ(7,"ion-buttons",4),e.YNc(8,t,2,0,"ion-button",5),e.qZA(),e.YNc(9,P,1,0,"div",6),e.qZA()(),e.TgZ(10,"ion-content",7)(11,"ion-fab",8)(12,"ion-fab-button",1),e.NdJ("click",function(){return _.onAddPhoto()}),e._UZ(13,"ion-icon",9),e.qZA()(),e.YNc(14,M,2,1,"div",10),e.YNc(15,S,4,0,"ng-template",null,11,e.W1O),e.qZA()),2&l){const c=e.MAs(16);e.xp6(8),e.Q6J("ngIf",_.isNew&&_.orderItemAttachments.length>0),e.xp6(1),e.Q6J("ngIf",!_.isNew),e.xp6(5),e.Q6J("ngIf",_.orderItemAttachments.length>0)("ngIfElse",c)}},dependencies:[L.sg,L.O5,h.BJ,h.YG,h.Sm,h.W2,h.IJ,h.W4,h.Gu,h.gu,h.wd,h.sr,f.A6],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%], p[_ngcontent-%COMP%], span[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{margin:0!important}.photos[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column;gap:10px}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{display:flex;height:auto;width:100%;position:relative;min-height:40px}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   ion-img-viewer[_ngcontent-%COMP%]{display:flex!important;flex-grow:1!important;height:100%;width:100%!important;justify-content:center}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   ion-img-viewer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%!important;object-fit:contain!important}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   .remove-button[_ngcontent-%COMP%]{position:absolute;right:-15px;top:-15px}"]})}}}]);