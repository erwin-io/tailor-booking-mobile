"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3741],{5641:(b,y,s)=>{s.d(y,{f:()=>g});var l=s(5e3);let g=(()=>{class p{onClick(){setTimeout(()=>{let c=null,h=document.getElementsByClassName("action-sheet-button");if(h.length>0){for(const u of h)if(u.classList.contains("action-sheet-selected")){c=u;break}}else{h=document.getElementsByClassName("alert-radio-button"),0===h.length&&(h=document.getElementsByClassName("sc-ion-select-popover"));for(const u of h){const v=u.attributes.getNamedItem("aria-checked");if(v&&"true"===v.value){c=u;break}}}c&&c.scrollIntoView({block:"center"})},250)}}return p.\u0275fac=function(c){return new(c||p)},p.\u0275dir=l.lG2({type:p,selectors:[["ion-select"]],hostBindings:function(c,h){1&c&&l.NdJ("click",function(){return h.onClick()})}}),p})()},8349:(b,y,s)=>{s.d(y,{n:()=>l});var l=(()=>{return(n=l||(l={}))[n.ACTIVE=1]="ACTIVE",n[n.DELETED=2]="DELETED",l;var n})()},5671:(b,y,s)=>{s.d(y,{C:()=>l});var l=(()=>{return(n=l||(l={}))[n.PENDING=1]="PENDING",n[n.APPROVED=2]="APPROVED",n[n.PROCESSED=3]="PROCESSED",n[n.COMPLETED=4]="COMPLETED",n[n.DECLINED=5]="DECLINED",n[n.CANCELLED=6]="CANCELLED",l;var n})()},8559:(b,y,s)=>{s.d(y,{O:()=>n});var l=s(5e3);let n=(()=>{class g{transform(e,c){let h=e+"";for(;h.length<c;)h="0"+h;return h}}return g.\u0275fac=function(e){return new(e||g)},g.\u0275pipe=l.Yjl({name:"numberLeadZero",type:g,pure:!0}),g})()},8791:(b,y,s)=>{s.d(y,{R:()=>u});var l=s(1086),n=s(2868),g=s(7221),p=s(2340),e=s(5e3),c=s(520),h=s(9709);let u=(()=>{class v{constructor(a,f){this.http=a,this.appconfig=f}getByRervationId(a){return this.http.get(p.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.getByReservationId+a).pipe((0,n.b)(f=>this.log("order item")),(0,g.K)(this.handleError("order item",[])))}create(a){return this.http.post(p.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.create,a).pipe((0,n.b)(f=>this.log("order item")),(0,g.K)(this.handleError("order item",[])))}update(a){return this.http.put(p.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.update,a).pipe((0,n.b)(f=>this.log("order item")),(0,g.K)(this.handleError("order item",[])))}getById(a){return this.http.get(p.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.getById+a).pipe((0,n.b)(f=>this.log("order item")),(0,g.K)(this.handleError("order item",[])))}delete(a){return this.http.delete(p.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.delete+a).pipe((0,n.b)(f=>this.log("rder it")),(0,g.K)(this.handleError("rder it",[])))}handleError(a="operation",f){return I=>(console.log(I),this.log(`${a} failed: ${Array.isArray(I.error.message)?I.error.message[0]:I.error.message}`),(0,l.of)(I.error))}log(a){console.log(a)}}return v.\u0275fac=function(a){return new(a||v)(e.LFG(c.eN),e.LFG(h._))},v.\u0275prov=e.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},2669:(b,y,s)=>{s.d(y,{D:()=>u});var l=s(1086),n=s(2868),g=s(7221),p=s(2340),e=s(5e3),c=s(520),h=s(9709);let u=(()=>{class v{constructor(a,f){this.http=a,this.appconfig=f}getByStatus(a){return this.http.get(p.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.getByStatus,{params:a}).pipe((0,n.b)(f=>this.log("reservation")),(0,g.K)(this.handleError("reservation",[])))}getById(a){return this.http.get(p.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.getById+a).pipe((0,n.b)(f=>this.log("reservation")),(0,g.K)(this.handleError("reservation",[])))}getReservationsForADay(a){return this.http.get(p.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.getReservationForADay+a).pipe((0,n.b)(f=>this.log("reservation")),(0,g.K)(this.handleError("reservation",[])))}createReservation(a){return this.http.post(p.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.createReservation,a).pipe((0,n.b)(f=>this.log("reservation")),(0,g.K)(this.handleError("reservation",[])))}rescheduleReservation(a){return this.http.put(p.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.rescheduleReservation,a).pipe((0,n.b)(f=>this.log("reservation")),(0,g.K)(this.handleError("reservation",[])))}updateReservationStatus(a){return this.http.put(p.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.updateReservationStatus,a).pipe((0,n.b)(f=>this.log("reservation")),(0,g.K)(this.handleError("reservation",[])))}handleError(a="operation",f){return I=>(this.log(`${a} failed: ${Array.isArray(I.error.message)?I.error.message[0]:I.error.message}`),(0,l.of)(I.error))}log(a){console.log(a)}}return v.\u0275fac=function(a){return new(a||v)(e.LFG(c.eN),e.LFG(h._))},v.\u0275prov=e.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},7956:(b,y,s)=>{s.d(y,{p:()=>e});var l=s(655),n=s(5e3),g=s(8779);let p=(()=>{class c{constructor(){this.message="Loading..."}ngOnInit(){}}return c.\u0275fac=function(u){return new(u||c)},c.\u0275cmp=n.Xpm({type:c,selectors:[["app-page-loader"]],decls:5,vars:1,consts:[[1,"container"],[1,"holder"],["color","primary"]],template:function(u,v){1&u&&(n.TgZ(0,"div",0)(1,"div",1),n._UZ(2,"ion-spinner",2),n.TgZ(3,"span"),n._uU(4),n.qZA()()()),2&u&&(n.xp6(4),n.Oqu(v.message))},dependencies:[g.PQ],styles:[".container{height:100%;display:flex;align-items:center;flex-direction:column;justify-content:center}.container .holder{display:flex;align-items:center;gap:10px;flex-direction:column;font-size:20px;text-shadow:none!important}\n"],encapsulation:2}),c})(),e=(()=>{class c{constructor(u){this.modalCtrl=u}open(u){return(0,l.mG)(this,void 0,void 0,function*(){this.modal&&(yield this.modal.dismiss()),this.modal=yield this.modalCtrl.create({component:p,id:"page-loader",cssClass:"modal-fullscreen",canDismiss:!1,componentProps:{message:u}}),this.modal.present()})}close(){return(0,l.mG)(this,void 0,void 0,function*(){this.modal.canDismiss=!0,yield this.modal.dismiss()})}}return c.\u0275fac=function(u){return new(u||c)(n.LFG(g.IN))},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},8305:(b,y,s)=>{s.d(y,{O:()=>U});var l=s(655),n=s(8349),g=s(5671),p=s(8164),e=s(5e3),c=s(8779),h=s(7956),u=s(3746),v=s(8386),t=s(9709),a=s(8791),f=s(2669),I=s(9808),D=s(8559);function L(_,E){if(1&_){const r=e.EpF();e.TgZ(0,"ion-item",23),e.NdJ("click",function(){e.CHM(r);const A=e.oxw(2);return e.KtG(A.onAddItem())}),e._UZ(1,"ion-icon",24),e.TgZ(2,"ion-label")(3,"h3",14),e._uU(4,"Add more item"),e.qZA()()()}}function x(_,E){if(1&_){const r=e.EpF();e.TgZ(0,"ion-icon",30),e.NdJ("click",function(){e.CHM(r);const A=e.oxw().$implicit,T=e.oxw(2);return e.KtG(T.details.orderItems.length>1?T.onRemoveItem(A.orderItemId):T.onCancelReservation())}),e.qZA()}}function S(_,E){if(1&_){const r=e.EpF();e.TgZ(0,"ion-item",25)(1,"ion-label",26),e.NdJ("click",function(){const T=e.CHM(r).$implicit,C=e.oxw(2);return e.KtG(C.onOpenItemDetails(T))}),e.TgZ(2,"h3",14),e._uU(3),e.qZA(),e.TgZ(4,"div",27)(5,"h2",28),e._uU(6),e.qZA()()(),e.YNc(7,x,1,0,"ion-icon",29),e.qZA()}if(2&_){const r=E.$implicit,d=e.oxw(2);e.xp6(3),e.AsE("x",r.quantity,"\xa0-\xa0",r.orderItemType.name,""),e.xp6(3),e.Oqu(r.remarks),e.xp6(1),e.Q6J("ngIf","1"===d.details.reservationStatus.reservationStatusId)}}function Z(_,E){if(1&_&&(e.TgZ(0,"div",10)(1,"ion-item",11)(2,"ion-label",12)(3,"div",11)(4,"h2",13),e._uU(5,"# "),e.TgZ(6,"strong"),e._uU(7),e.ALo(8,"numberLeadZero"),e.qZA()()()()(),e.TgZ(9,"ion-item",11)(10,"ion-label",12)(11,"h3",14)(12,"strong")(13,"ion-text",15),e._uU(14),e.qZA()()(),e.TgZ(15,"h3",16),e._uU(16,"Status"),e.qZA()()(),e.TgZ(17,"ion-item",11),e._UZ(18,"ion-icon",17),e.TgZ(19,"ion-label",12)(20,"h3",14),e._uU(21),e.qZA()()(),e.TgZ(22,"ion-item",11),e._UZ(23,"ion-icon",18),e.TgZ(24,"ion-label",12)(25,"h3",14),e._uU(26),e.ALo(27,"date"),e.qZA()()(),e.TgZ(28,"ion-item",11),e._UZ(29,"ion-icon",19),e.TgZ(30,"ion-label",12)(31,"h2",13),e._uU(32),e.qZA(),e.TgZ(33,"span",16),e._uU(34),e.qZA()()(),e.TgZ(35,"ion-item",11)(36,"ion-label",12)(37,"h2",14)(38,"strong"),e._uU(39,"Items"),e.qZA()()()(),e.YNc(40,L,5,0,"ion-item",20),e.TgZ(41,"ion-list",21),e.YNc(42,S,8,4,"ion-item",22),e.qZA()()),2&_){const r=e.oxw();let d;e.xp6(7),e.Oqu(e.xi3(8,10,r.details.reservationId,5)),e.xp6(6),e.Q6J("color",("1"===r.details.reservationStatus.reservationStatusId||"4"===r.details.reservationStatus.reservationStatusId?"danger":"")||("2"===r.details.reservationStatus.reservationStatusId?"primary":"")||(null!==(d="3"===r.details.reservationStatus.reservationStatusId)&&void 0!==d?d:"tertiary")),e.xp6(1),e.hij(" ",r.details.reservationStatus.name," "),e.xp6(7),e.Oqu(r.details.reservationLevel.name),e.xp6(5),e.Oqu(e.xi3(27,13,r.details.reqCompletionDate,"MMMM dd, YYYY")),e.xp6(6),e.Oqu(r.details.description),e.xp6(2),e.Oqu(""!==r.details.description?"Remarks":"No Remarks"),e.xp6(6),e.Q6J("ngIf","1"===r.details.reservationStatus.reservationStatusId),e.xp6(1),e.Q6J("lines",r.details.orderItems.length>1?"":"none"),e.xp6(1),e.Q6J("ngForOf",r.details.orderItems)}}function M(_,E){1&_&&(e.TgZ(0,"div",10)(1,"ion-item",11)(2,"ion-label",12)(3,"h3",14)(4,"strong")(5,"ion-text"),e._UZ(6,"ion-skeleton-text",31),e.qZA()()(),e.TgZ(7,"h3",16),e._UZ(8,"ion-skeleton-text",31),e.qZA()()(),e.TgZ(9,"ion-item",11)(10,"ion-label",12)(11,"div",32)(12,"h1",13),e._UZ(13,"ion-skeleton-text",31),e.qZA(),e.TgZ(14,"h3",14),e._UZ(15,"ion-skeleton-text",31),e.qZA()()()(),e.TgZ(16,"ion-item",11),e._UZ(17,"ion-icon",18),e.TgZ(18,"ion-label",12)(19,"h3",14),e._UZ(20,"ion-skeleton-text",31),e.qZA(),e.TgZ(21,"h3",14),e._UZ(22,"ion-skeleton-text",31),e.qZA()()()()),2&_&&(e.xp6(6),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(5),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(5),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0))}function B(_,E){if(1&_){const r=e.EpF();e.TgZ(0,"ion-button",33),e.NdJ("click",function(){e.CHM(r);const A=e.oxw();return e.KtG(A.onCancelReservation())}),e._uU(1,"Cancel reservation"),e.qZA()}if(2&_){const r=e.oxw();e.Q6J("disabled",r.isLoading)}}let U=(()=>{class _{constructor(r,d,A,T,C,K,N,k,R,G){this.modalCtrl=r,this.alertController=d,this.actionSheetController=A,this.platform=T,this.pageLoaderService=C,this.storageService=K,this.userService=N,this.appconfig=k,this.orderItemService=R,this.reservationService=G,this.hasChanges=!1,this.isLoading=!1,this.details={},this.platform.backButton.subscribeWithPriority(-1,()=>{this.cancel()})}ngOnInit(){this.getReservation(this.details.reservationId)}getReservation(r){return(0,l.mG)(this,void 0,void 0,function*(){try{this.isLoading=!0,this.reservationService.getById(r).subscribe(d=>(0,l.mG)(this,void 0,void 0,function*(){d.success?(this.details=d.data,this.details.orderItems=d.data.orderItems.filter(A=>A.entityStatus.entityStatusId===n.n.ACTIVE.toString()),this.isLoading=!1):yield this.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]})}),d=>(0,l.mG)(this,void 0,void 0,function*(){yield this.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]}),this.isLoading=!1}))}catch(d){this.isLoading=!1,yield this.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]})}})}onAddItem(){return(0,l.mG)(this,void 0,void 0,function*(){const r=yield this.modalCtrl.create({component:p.Q,cssClass:"modal-fullscreen",componentProps:{reservation:this.details,canEdit:!0,currentUser:this.currentUser}});r.present(),yield r.onWillDismiss().then(d=>(0,l.mG)(this,void 0,void 0,function*(){d.data&&(yield this.getReservation(this.details.reservationId))}))})}onOpenItemDetails(r){return(0,l.mG)(this,void 0,void 0,function*(){const d=yield this.modalCtrl.create({component:p.Q,cssClass:"modal-fullscreen",componentProps:{details:r,reservation:this.details,canEdit:this.details.reservationStatus.reservationStatusId===g.C.PENDING.toString(),currentUser:this.currentUser}});d.present();const{role:T}=yield d.onWillDismiss();"confirm"===T&&(yield this.getReservation(this.details.reservationId))})}onRemoveItem(r){return(0,l.mG)(this,void 0,void 0,function*(){try{yield this.presentAlert({header:"Are you sure you want to remove this item?",buttons:[{text:"CANCEL",role:"cancel"},{text:"YES Continue",role:"confirm",handler:()=>(0,l.mG)(this,void 0,void 0,function*(){yield this.pageLoaderService.open("Processing please wait..."),this.isLoading=!0,this.orderItemService.delete(r).subscribe(d=>(0,l.mG)(this,void 0,void 0,function*(){d.success?(yield this.pageLoaderService.close(),yield this.presentAlert({header:"Item deleted!",buttons:["OK"]}),this.isLoading=!1,yield this.pageLoaderService.close(),yield this.getReservation(this.details.reservationId)):(yield this.pageLoaderService.close(),this.isLoading=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]}))}),d=>(0,l.mG)(this,void 0,void 0,function*(){yield this.pageLoaderService.close(),this.isLoading=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]})}))})}]})}catch(d){yield this.pageLoaderService.close(),this.isLoading=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]})}})}onCancelReservation(){return(0,l.mG)(this,void 0,void 0,function*(){yield this.presentAlert({header:"Are you sure you want to cancel reservation?",buttons:[{text:"BACK",role:"cancel"},{text:"YES",role:"confirm",handler:()=>(0,l.mG)(this,void 0,void 0,function*(){this.cancelReservation()})}]})})}cancelReservation(){return(0,l.mG)(this,void 0,void 0,function*(){try{yield this.pageLoaderService.open("Processing please wait..."),this.isLoading=!0,this.reservationService.updateReservationStatus({reservationId:this.details.reservationId,reservationStatusId:g.C.CANCELLED}).subscribe(r=>(0,l.mG)(this,void 0,void 0,function*(){if(r.success)return this.hasChanges=!0,yield this.pageLoaderService.close(),yield this.presentAlert({header:"Reservation cancelled!",buttons:["OK"]}),this.isLoading=!1,this.modalCtrl.dismiss(!0,"confirm");yield this.pageLoaderService.close(),this.isLoading=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(r.message)?r.message[0]:r.message,buttons:["OK"]})}),r=>(0,l.mG)(this,void 0,void 0,function*(){yield this.pageLoaderService.close(),this.isLoading=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(r.message)?r.message[0]:r.message,buttons:["OK"]})}))}catch(r){yield this.pageLoaderService.close(),this.isLoading=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(r.message)?r.message[0]:r.message,buttons:["OK"]})}})}cancel(){return this.modalCtrl.dismiss(this.hasChanges?this.hasChanges:null,"cancel")}presentAlert(r){return(0,l.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create(r)).present()})}}return _.\u0275fac=function(r){return new(r||_)(e.Y36(c.IN),e.Y36(c.Br),e.Y36(c.BX),e.Y36(c.t4),e.Y36(h.p),e.Y36(u.V),e.Y36(v.K),e.Y36(t._),e.Y36(a.R),e.Y36(f.D))},_.\u0275cmp=e.Xpm({type:_,selectors:[["app-booking-details"]],decls:14,vars:4,consts:[["slot","start"],[3,"disabled","click"],["name","chevron-back"],[2,"text-align","center"],["slot","end",2,"width","48px"],[1,"ion-padding"],["class","details-container",4,"ngIf","ngIfElse"],["loading",""],[1,"sched-controls-bottom"],["color","danger","expand","block","fill","outline",3,"disabled","click",4,"ngIf"],[1,"details-container"],[1,"item"],["text-wrap",""],[1,"title"],[1,"sub"],[3,"color"],[1,"desc"],["name","alert-circle","slot","start"],["name","today","slot","start"],["name","pricetag","slot","start"],["button","","class","ion-no-padding","detail","false",3,"click",4,"ngIf"],[3,"lines"],["button","","detail","false","class","item",4,"ngFor","ngForOf"],["button","","detail","false",1,"ion-no-padding",3,"click"],["name","add-outline"],["button","","detail","false",1,"item"],[3,"click"],[1,"attribute"],[1,"remarks","sub"],["name","trash-outline",3,"click",4,"ngIf"],["name","trash-outline",3,"click"],[3,"animated"],[1,"item","type"],["color","danger","expand","block","fill","outline",3,"disabled","click"]],template:function(r,d){if(1&r&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return d.cancel()}),e._UZ(4,"ion-icon",2),e.qZA()(),e.TgZ(5,"ion-title",3),e._uU(6,"Details"),e.qZA(),e._UZ(7,"div",4),e.qZA()(),e.TgZ(8,"ion-content",5),e.YNc(9,Z,43,16,"div",6),e.YNc(10,M,23,6,"ng-template",null,7,e.W1O),e.qZA(),e.TgZ(12,"div",8),e.YNc(13,B,2,1,"ion-button",9),e.qZA()),2&r){const A=e.MAs(11);e.xp6(3),e.Q6J("disabled",d.isLoading),e.xp6(6),e.Q6J("ngIf",!d.isLoading)("ngIfElse",A),e.xp6(4),e.Q6J("ngIf",!d.isLoading&&"1"===d.details.reservationStatus.reservationStatusId)}},dependencies:[I.sg,I.O5,c.YG,c.Sm,c.W2,c.Gu,c.gu,c.Ie,c.Q$,c.q_,c.CK,c.yW,c.wd,c.sr,I.uU,D.O],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}.message-header-button[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{position:absolute;z-index:9;top:0;right:-10px;font-size:12px}.video-conference-button.disabled[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#0003!important}.video-conference-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#26a69a}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{color:#000!important;display:flex;flex-direction:column}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{margin:5px 0!important}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]{color:#999!important}.details-container[_ngcontent-%COMP%]   .item.type[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:500}.sched-controls-bottom[_ngcontent-%COMP%]{position:relative;display:block;width:100%;background:#ffffff;padding:5px 10px;box-shadow:0 3px 10px #0003}.sched-controls-bottom[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:45px;font-size:15px}.photos[_ngcontent-%COMP%]{row-gap:10px;display:flex;flex-direction:column;box-sizing:border-box;width:100%;padding:10px}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:auto}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:200px;border-radius:10px;object-position:center;object-fit:contain;box-shadow:0 0 10px #7a7a7a75}"]}),_})()},8164:(b,y,s)=>{s.d(y,{Q:()=>F});var l=s(655),n=s(3075),g=s(567);class h{}var v=s(8305),t=s(5e3),a=s(8779),f=s(7956),I=s(3746),D=s(8386),L=s(9709),x=s(8791),S=s(1086),Z=s(2868),M=s(7221),B=s(2340),U=s(520);let _=(()=>{class m{constructor(o,i){this.http=o,this.appconfig=i}getAll(){return this.http.get(B.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItemType.getAll).pipe((0,Z.b)(o=>this.log("order item type")),(0,M.K)(this.handleError("order item type",[])))}handleError(o="operation",i){return O=>(this.log(`${o} failed: ${Array.isArray(O.error.message)?O.error.message[0]:O.error.message}`),(0,S.of)(O.error))}log(o){console.log(o)}}return m.\u0275fac=function(o){return new(o||m)(t.LFG(U.eN),t.LFG(L._))},m.\u0275prov=t.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})();var E=s(9808),r=s(7322),d=s(7531),A=s(5641),T=s(8559);function C(m,P){if(1&m){const o=t.EpF();t.TgZ(0,"ion-buttons",15)(1,"ion-button",1),t.NdJ("click",function(){t.CHM(o);const O=t.oxw();return t.KtG(O.onSubmit())}),t._UZ(2,"ion-icon",16),t.qZA()()}if(2&m){const o=t.oxw();t.xp6(1),t.Q6J("disabled",o.isLoading||!o.itemForm.valid)}}function K(m,P){1&m&&t._UZ(0,"div",17)}function N(m,P){if(1&m){const o=t.EpF();t.TgZ(0,"ion-list")(1,"ion-item",18),t.NdJ("click",function(){t.CHM(o);const O=t.oxw();return t.KtG(O.onOpenDetails())}),t.TgZ(2,"ion-label")(3,"div")(4,"h3")(5,"strong"),t._uU(6),t.ALo(7,"numberLeadZero"),t.TgZ(8,"ion-text",19),t._uU(9),t.qZA()()()()()()()}if(2&m){const o=t.oxw();let i;t.xp6(6),t.hij("ID #: ",o.reservation?t.xi3(7,3,o.reservation.reservationId,5):""," "),t.xp6(2),t.Q6J("color",("1"===o.reservation.reservationStatus.reservationStatusId||"4"===o.reservation.reservationStatus.reservationStatusId?"danger":"")||("2"===o.reservation.reservationStatus.reservationStatusId?"primary":"")||(null!==(i="3"===o.reservation.reservationStatus.reservationStatusId)&&void 0!==i?i:"tertiary")),t.xp6(1),t.hij(" ",o.reservation.reservationStatus.name," ")}}function k(m,P){if(1&m&&(t.TgZ(0,"ion-select-option",23),t._uU(1),t.qZA()),2&m){const o=P.$implicit;t.s9C("value",o.orderItemTypeId.toString()),t.xp6(1),t.Oqu(o.name)}}function R(m,P){if(1&m&&(t.TgZ(0,"ion-item",20)(1,"ion-select",21),t.YNc(2,k,2,2,"ion-select-option",22),t.qZA()()),2&m){const o=t.oxw();t.Q6J("disabled",o.isLoading),t.xp6(2),t.Q6J("ngForOf",o.orderItemTypeOption)}}function G(m,P){if(1&m&&(t.TgZ(0,"ion-radio-group")(1,"ion-item",24)(2,"ion-label"),t._uU(3),t.qZA()()()),2&m){const o=t.oxw();t.xp6(3),t.Oqu(o.details.orderItemType.name)}}function Y(m,P){1&m&&(t.TgZ(0,"span",25),t._uU(1," Please select a type of item "),t.qZA())}let F=(()=>{class m{constructor(o,i,O,J,W,Q,q,w,j,H,V){this.modalCtrl=o,this.alertController=i,this.actionSheetController=O,this.platform=J,this.formBuilder=W,this.pageLoaderService=Q,this.storageService=q,this.userService=w,this.appconfig=j,this.orderItemService=H,this.orderItemTypeService=V,this.canEdit=!1,this.hasChanges=!1,this.isLoading=!1,this.isSubmitting=!1,this.isLoadingFilter=!1,this.orderItemTypeOption=[],this.platform.backButton.subscribeWithPriority(-1,()=>{this.cancel()})}get isNew(){return!this.details||!this.details.orderItemId&&""===this.details.orderItemId}get formData(){return Object.assign(Object.assign({},this.itemForm.value),{orderItemId:this.isNew?null:this.details.orderItemId,reservationId:this.reservation?this.reservation.reservationId:null})}get errorControls(){return this.itemForm.controls}initFilter(){this.isLoadingFilter=!0,(0,g.D)([this.orderItemTypeService.getAll()]).subscribe(([o])=>{this.orderItemTypeOption=o.data},o=>console.error(o),()=>(0,l.mG)(this,void 0,void 0,function*(){this.isLoadingFilter=!1,this.details&&this.details.orderItemId?(yield this.getOrderItem(this.details.orderItemId),this.itemForm.controls.quantity.setValue(this.details.quantity),this.itemForm.controls.remarks.setValue(this.details.remarks)):this.details&&(console.log(this.details),this.itemForm.controls.orderItemTypeId.setValue(this.details.orderItemType.orderItemTypeId),this.itemForm.controls.quantity.setValue(this.details.quantity),this.itemForm.controls.remarks.setValue(this.details.remarks))}))}ngOnInit(){this.itemForm=new n.cw({orderItemTypeId:new n.NI(null,n.kI.required),quantity:new n.NI(null,[n.kI.required,n.kI.min(1)]),remarks:new n.NI(null,n.kI.required)}),this.initFilter()}getOrderItem(o){return(0,l.mG)(this,void 0,void 0,function*(){try{this.isLoading=!0,this.orderItemService.getById(o).subscribe(i=>(0,l.mG)(this,void 0,void 0,function*(){i.success?(console.log(this.details),this.details=Object.assign(Object.assign({},i.data),this.details),console.log(this.details),this.isLoading=!1,this.itemForm.controls.orderItemTypeId.setValue(i.data.orderItemType.orderItemTypeId)):yield this.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]})}),i=>(0,l.mG)(this,void 0,void 0,function*(){yield this.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]}),this.isLoading=!1}))}catch(i){yield this.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]})}})}onSubmit(){return(0,l.mG)(this,void 0,void 0,function*(){const o=this.formData;try{if(this.isSubmitting=!0,this.isNew)if(this.reservation&&""!==this.reservation.reservationId)yield this.pageLoaderService.open("Saving item..."),this.orderItemService.create(o).subscribe(i=>(0,l.mG)(this,void 0,void 0,function*(){i.success?(yield this.presentAlert({header:"Saved!",buttons:["OK"]}),this.isSubmitting=!1,this.modal.canDismiss=!0,this.modal.dismiss({success:!0,data:i.data},"confirm"),yield this.pageLoaderService.close()):(yield this.pageLoaderService.close(),this.isSubmitting=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]}))}),i=>(0,l.mG)(this,void 0,void 0,function*(){yield this.pageLoaderService.close(),this.isSubmitting=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]})}));else{const i=new h;i.quantity=this.formData.quantity,i.orderItemType=this.orderItemTypeOption.filter(O=>O.orderItemTypeId===this.formData.orderItemTypeId)[0],i.remarks=this.formData.remarks,this.modal.dismiss({success:!0,data:i},"confirm")}else if(this.details&&this.details.reservation&&""!==this.details.reservation.reservationId)yield this.pageLoaderService.open("Saving item..."),this.orderItemService.update(o).subscribe(i=>(0,l.mG)(this,void 0,void 0,function*(){i.success?(yield this.presentAlert({header:"Saved!",buttons:["OK"]}),this.isSubmitting=!1,this.modal.canDismiss=!0,this.modal.dismiss({success:!0,data:i.data},"confirm"),yield this.pageLoaderService.close()):(yield this.pageLoaderService.close(),this.isSubmitting=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]}))}),i=>(0,l.mG)(this,void 0,void 0,function*(){yield this.pageLoaderService.close(),this.isSubmitting=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]})}));else{const i=new h;i.quantity=this.formData.quantity,i.orderItemType=this.orderItemTypeOption.filter(O=>O.orderItemTypeId===this.formData.orderItemTypeId)[0],i.remarks=this.formData.remarks,this.modal.dismiss({success:!0,data:i},"confirm")}}catch(i){yield this.pageLoaderService.close(),this.isSubmitting=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]})}})}delete(){return(0,l.mG)(this,void 0,void 0,function*(){try{yield this.pageLoaderService.open("Processing please wait..."),this.isLoading=!0,this.orderItemService.delete(this.details.orderItemId).subscribe(o=>(0,l.mG)(this,void 0,void 0,function*(){if(o.success)return this.hasChanges=!0,yield this.pageLoaderService.close(),yield this.presentAlert({header:"Item deleted!",buttons:["OK"]}),this.isLoading=!1,this.modalCtrl.dismiss(!0,"confirm");yield this.pageLoaderService.close(),this.isLoading=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(o.message)?o.message[0]:o.message,buttons:["OK"]})}),o=>(0,l.mG)(this,void 0,void 0,function*(){yield this.pageLoaderService.close(),this.isLoading=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(o.message)?o.message[0]:o.message,buttons:["OK"]})}))}catch(o){yield this.pageLoaderService.close(),this.isLoading=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(o.message)?o.message[0]:o.message,buttons:["OK"]})}})}onOpenDetails(){return(0,l.mG)(this,void 0,void 0,function*(){this.modalCtrl.dismiss();const o=yield this.modalCtrl.create({component:v.O,cssClass:"modal-fullscreen",componentProps:{details:this.reservation,currentUser:this.currentUser}});o.present(),yield o.onWillDismiss()})}cancel(){return this.modalCtrl.dismiss(this.hasChanges?this.hasChanges:null,"cancel")}presentAlert(o){return(0,l.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create(o)).present()})}}return m.\u0275fac=function(o){return new(o||m)(t.Y36(a.IN),t.Y36(a.Br),t.Y36(a.BX),t.Y36(a.t4),t.Y36(n.qu),t.Y36(f.p),t.Y36(I.V),t.Y36(D.K),t.Y36(L._),t.Y36(x.R),t.Y36(_))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-booking-item-add"]],decls:29,vars:11,consts:[["slot","start"],[3,"disabled","click"],["name","chevron-back"],[2,"text-align","center"],["slot","end",4,"ngIf"],["slot","end","style","width: 48px",4,"ngIf"],[1,"ion-padding"],["id","itemForm",3,"formGroup","ngSubmit"],[4,"ngIf"],[1,"form-field-group"],["fill","outline",3,"disabled",4,"ngIf"],["class","error",4,"ngIf"],["appearance","outline"],["matInput","","type","number","placeholder","Quantity","formControlName","quantity","autocomplete","new-quantity",3,"readonly"],["matInput","","type","text","placeholder","Remarks","formControlName","remarks","autocomplete","new-quantity",2,"height","200px",3,"readonly"],["slot","end"],["name","checkmark-outline"],["slot","end",2,"width","48px"],["lines","none","button","","detail","true",3,"click"],[3,"color"],["fill","outline",3,"disabled"],["slot","start","formControlName","orderItemTypeId","placeholder","Select type"],["slot","start",3,"value",4,"ngFor","ngForOf"],["slot","start",3,"value"],["fill","outline","lines","none"],[1,"error"]],template:function(o,i){1&o&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return i.cancel()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-title",3),t._uU(6),t.qZA(),t.YNc(7,C,3,1,"ion-buttons",4),t.YNc(8,K,1,0,"div",5),t.qZA()(),t.TgZ(9,"ion-content",6)(10,"form",7),t.NdJ("ngSubmit",function(){return i.onSubmit()}),t.TgZ(11,"fieldset"),t.YNc(12,N,10,6,"ion-list",8),t.TgZ(13,"div",9)(14,"mat-label",0),t._uU(15,"What type of item"),t.qZA(),t.YNc(16,R,3,2,"ion-item",10),t.YNc(17,G,4,1,"ion-radio-group",8),t.YNc(18,Y,2,0,"span",11),t.qZA(),t.TgZ(19,"div",9)(20,"mat-form-field",12)(21,"mat-label"),t._uU(22,"Quantity"),t.qZA(),t._UZ(23,"input",13),t.qZA()(),t.TgZ(24,"div",9)(25,"mat-form-field",12)(26,"mat-label"),t._uU(27,"Remarks"),t.qZA(),t._UZ(28,"textarea",14),t.qZA()()()()()),2&o&&(t.xp6(3),t.Q6J("disabled",i.isLoading),t.xp6(3),t.Oqu(i.isLoading?"":i.isNew?"New item":i.canEdit?"Edit item":"Details"),t.xp6(1),t.Q6J("ngIf",i.canEdit),t.xp6(1),t.Q6J("ngIf",!i.canEdit),t.xp6(2),t.Q6J("formGroup",i.itemForm),t.xp6(2),t.Q6J("ngIf",!i.isLoading&&(i.reservation&&!i.isNew||i.reservation&&i.isNew)),t.xp6(4),t.Q6J("ngIf",i.canEdit),t.xp6(1),t.Q6J("ngIf",!i.canEdit),t.xp6(1),t.Q6J("ngIf",i.errorControls.orderItemTypeId.touched&&i.errorControls.orderItemTypeId.errors&&i.errorControls.orderItemTypeId.errors.required),t.xp6(5),t.Q6J("readonly",!i.canEdit),t.xp6(5),t.Q6J("readonly",!i.canEdit))},dependencies:[E.sg,E.O5,n._Y,n.Fj,n.wV,n.JJ,n.JL,n.sg,n.u,a.YG,a.Sm,a.W2,a.Gu,a.gu,a.Ie,a.Q$,a.q_,a.se,a.t9,a.n0,a.yW,a.wd,a.sr,a.QI,r.KE,r.hX,d.Nt,A.f,T.O],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}"]}),m})()}}]);