"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3741],{76:(x,C,r)=>{r.d(C,{GW:()=>o,dk:()=>y,oK:()=>s});var s=(()=>{return(v=s||(s={})).Prompt="PROMPT",v.Camera="CAMERA",v.Photos="PHOTOS",s;var v})(),o=(()=>{return(v=o||(o={})).Rear="REAR",v.Front="FRONT",o;var v})(),y=(()=>{return(v=y||(y={})).Uri="uri",v.Base64="base64",v.DataUrl="dataUrl",y;var v})()},6388:(x,C,r)=>{r.d(C,{V1:()=>y,dk:()=>o.dk,oK:()=>o.oK});var s=r(7423),o=r(76);const y=(0,s.fo)("Camera",{web:()=>r.e(3954).then(r.bind(r,3954)).then(v=>new v.CameraWeb)})},1067:(x,C,r)=>{r.d(C,{fy:()=>o});const o=(0,r(7423).fo)("Filesystem",{web:()=>r.e(6364).then(r.bind(r,6364)).then(y=>new y.FilesystemWeb)})},5641:(x,C,r)=>{r.d(C,{f:()=>y});var s=r(4650);class y{onClick(){setTimeout(()=>{let e=null,p=document.getElementsByClassName("action-sheet-button");if(p.length>0){for(const E of p)if(E.classList.contains("action-sheet-selected")){e=E;break}}else{p=document.getElementsByClassName("alert-radio-button"),0===p.length&&(p=document.getElementsByClassName("sc-ion-select-popover"));for(const E of p){const P=E.attributes.getNamedItem("aria-checked");if(P&&"true"===P.value){e=E;break}}}e&&e.scrollIntoView({block:"center"})},250)}static \u0275fac=function(p){return new(p||y)};static \u0275dir=s.lG2({type:y,selectors:[["ion-select"]],hostBindings:function(p,E){1&p&&s.NdJ("click",function(){return E.onClick()})}})}},8349:(x,C,r)=>{r.d(C,{n:()=>s});var s=(()=>{return(o=s||(s={}))[o.ACTIVE=1]="ACTIVE",o[o.DELETED=2]="DELETED",s;var o})()},5671:(x,C,r)=>{r.d(C,{C:()=>s});var s=(()=>{return(o=s||(s={}))[o.PENDING=1]="PENDING",o[o.APPROVED=2]="APPROVED",o[o.PROCESSED=3]="PROCESSED",o[o.COMPLETED=4]="COMPLETED",o[o.DECLINED=5]="DECLINED",o[o.CANCELLED=6]="CANCELLED",s;var o})()},8559:(x,C,r)=>{r.d(C,{O:()=>o});var s=r(4650);class o{transform(v,e){let p=v+"";for(;p.length<e;)p="0"+p;return p}static \u0275fac=function(e){return new(e||o)};static \u0275pipe=s.Yjl({name:"numberLeadZero",type:o,pure:!0})}},8791:(x,C,r)=>{r.d(C,{R:()=>P});var s=r(1086),o=r(2868),y=r(7221),v=r(2340),e=r(4650),p=r(529),E=r(9709);class P{http;appconfig;constructor(f,t){this.http=f,this.appconfig=t}getByRervationId(f){return this.http.get(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.getByReservationId+f).pipe((0,o.b)(t=>this.log("order item")),(0,y.K)(this.handleError("order item",[])))}create(f){return this.http.post(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.create,f).pipe((0,o.b)(t=>this.log("order item")),(0,y.K)(this.handleError("order item",[])))}update(f){return this.http.put(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.update,f).pipe((0,o.b)(t=>this.log("order item")),(0,y.K)(this.handleError("order item",[])))}getById(f){return this.http.get(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.getById+f).pipe((0,o.b)(t=>this.log("order item")),(0,y.K)(this.handleError("order item",[])))}delete(f){return this.http.delete(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.delete+f).pipe((0,o.b)(t=>this.log("rder it")),(0,y.K)(this.handleError("rder it",[])))}addAttachmentFile(f){return this.http.post(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.addAttachmentFile,f).pipe((0,o.b)(t=>this.log("order item")),(0,y.K)(this.handleError("order item",[])))}removeAttachmentFile(f){return this.http.delete(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItem.removeAttachmentFile+f).pipe((0,o.b)(t=>this.log("rder it")),(0,y.K)(this.handleError("rder it",[])))}handleError(f="operation",t){return O=>(this.log(`${f} failed: ${Array.isArray(O.error.message)?O.error.message[0]:O.error.message}`),(0,s.of)(O.error))}log(f){console.log(f)}static \u0275fac=function(t){return new(t||P)(e.LFG(p.eN),e.LFG(E._))};static \u0275prov=e.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"})}},2669:(x,C,r)=>{r.d(C,{D:()=>P});var s=r(1086),o=r(2868),y=r(7221),v=r(2340),e=r(4650),p=r(529),E=r(9709);class P{http;appconfig;constructor(f,t){this.http=f,this.appconfig=t}getByStatus(f){return this.http.get(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.getByStatus,{params:f}).pipe((0,o.b)(t=>this.log("reservation")),(0,y.K)(this.handleError("reservation",[])))}getById(f){return this.http.get(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.getById+f).pipe((0,o.b)(t=>this.log("reservation")),(0,y.K)(this.handleError("reservation",[])))}getReservationsForADay(f){return this.http.get(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.getReservationForADay+f).pipe((0,o.b)(t=>this.log("reservation")),(0,y.K)(this.handleError("reservation",[])))}createReservation(f){return this.http.post(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.createReservation,f).pipe((0,o.b)(t=>this.log("reservation")),(0,y.K)(this.handleError("reservation",[])))}rescheduleReservation(f){return this.http.put(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.rescheduleReservation,f).pipe((0,o.b)(t=>this.log("reservation")),(0,y.K)(this.handleError("reservation",[])))}updateReservationStatus(f){return this.http.put(v.N.apiBaseUrl+this.appconfig.config.apiEndPoints.reservation.updateReservationStatus,f).pipe((0,o.b)(t=>this.log("reservation")),(0,y.K)(this.handleError("reservation",[])))}handleError(f="operation",t){return O=>(this.log(`${f} failed: ${Array.isArray(O.error.message)?O.error.message[0]:O.error.message}`),(0,s.of)(O.error))}log(f){console.log(f)}static \u0275fac=function(t){return new(t||P)(e.LFG(p.eN),e.LFG(E._))};static \u0275prov=e.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"})}},7956:(x,C,r)=>{r.d(C,{p:()=>e});var s=r(5861),o=r(4650),y=r(603);class v{message="Loading...";constructor(){}ngOnInit(){}static \u0275fac=function(P){return new(P||v)};static \u0275cmp=o.Xpm({type:v,selectors:[["app-page-loader"]],decls:5,vars:1,consts:[[1,"container"],[1,"holder"],["color","primary"]],template:function(P,D){1&P&&(o.TgZ(0,"div",0)(1,"div",1),o._UZ(2,"ion-spinner",2),o.TgZ(3,"span"),o._uU(4),o.qZA()()()),2&P&&(o.xp6(4),o.Oqu(D.message))},dependencies:[y.PQ],styles:[".container{height:100%;display:flex;align-items:center;flex-direction:column;justify-content:center}.container .holder{display:flex;align-items:center;gap:10px;flex-direction:column;font-size:20px;text-shadow:none!important}\n"],encapsulation:2})}class e{modalCtrl;modal;constructor(E){this.modalCtrl=E}open(E){var P=this;return(0,s.Z)(function*(){P.modal&&(yield P.modal.dismiss()),P.modal=yield P.modalCtrl.create({component:v,id:"page-loader",cssClass:"modal-fullscreen",canDismiss:!1,componentProps:{message:E}}),P.modal.present()})()}close(){var E=this;return(0,s.Z)(function*(){E.modal.canDismiss=!0,yield E.modal.dismiss()})()}static \u0275fac=function(P){return new(P||e)(o.LFG(y.IN))};static \u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}},8305:(x,C,r)=>{r.d(C,{O:()=>d});var s=r(5861),o=r(8349),y=r(5671),v=r(8164),e=r(4650),p=r(603),E=r(7956),P=r(3746),D=r(8386),f=r(9709),t=r(8791),O=r(2669),M=r(6895),S=r(8559);function B(A,m){if(1&A){const i=e.EpF();e.TgZ(0,"ion-item",23),e.NdJ("click",function(){e.CHM(i);const I=e.oxw(2);return e.KtG(I.onAddItem())}),e._UZ(1,"ion-icon",24),e.TgZ(2,"ion-label")(3,"h3",14),e._uU(4,"Add more item"),e.qZA()()()}}function L(A,m){if(1&A){const i=e.EpF();e.TgZ(0,"ion-icon",30),e.NdJ("click",function(){e.CHM(i);const I=e.oxw().$implicit,T=e.oxw(2);return e.KtG(T.details.orderItems.length>1?T.onRemoveItem(I.orderItemId):T.onCancelReservation())}),e.qZA()}}function Z(A,m){if(1&A){const i=e.EpF();e.TgZ(0,"ion-item",25)(1,"ion-label",26),e.NdJ("click",function(){const T=e.CHM(i).$implicit,U=e.oxw(2);return e.KtG(U.onOpenItemDetails(T))}),e.TgZ(2,"h3",14),e._uU(3),e.qZA(),e.TgZ(4,"div",27)(5,"h2",28),e._uU(6),e.qZA()()(),e.YNc(7,L,1,0,"ion-icon",29),e.qZA()}if(2&A){const i=m.$implicit,_=e.oxw(2);e.xp6(3),e.AsE("x",i.quantity,"\xa0-\xa0",i.orderItemType.name,""),e.xp6(3),e.Oqu(i.remarks),e.xp6(1),e.Q6J("ngIf","1"===_.details.reservationStatus.reservationStatusId)}}function g(A,m){if(1&A&&(e.TgZ(0,"div",10)(1,"ion-item",11)(2,"ion-label",12)(3,"div",11)(4,"h2",13),e._uU(5,"# "),e.TgZ(6,"strong"),e._uU(7),e.ALo(8,"numberLeadZero"),e.qZA()()()()(),e.TgZ(9,"ion-item",11)(10,"ion-label",12)(11,"h3",14)(12,"strong")(13,"ion-text",15),e._uU(14),e.qZA()()(),e.TgZ(15,"h3",16),e._uU(16,"Status"),e.qZA()()(),e.TgZ(17,"ion-item",11),e._UZ(18,"ion-icon",17),e.TgZ(19,"ion-label",12)(20,"h3",14),e._uU(21),e.qZA()()(),e.TgZ(22,"ion-item",11),e._UZ(23,"ion-icon",18),e.TgZ(24,"ion-label",12)(25,"h3",14),e._uU(26),e.ALo(27,"date"),e.qZA()()(),e.TgZ(28,"ion-item",11),e._UZ(29,"ion-icon",19),e.TgZ(30,"ion-label",12)(31,"h2",13),e._uU(32),e.qZA(),e.TgZ(33,"span",16),e._uU(34),e.qZA()()(),e.TgZ(35,"ion-item",11)(36,"ion-label",12)(37,"h2",14)(38,"strong"),e._uU(39,"Items"),e.qZA()()()(),e.YNc(40,B,5,0,"ion-item",20),e.TgZ(41,"ion-list",21),e.YNc(42,Z,8,4,"ion-item",22),e.qZA()()),2&A){const i=e.oxw();let _;e.xp6(7),e.Oqu(e.xi3(8,10,i.details.reservationId,5)),e.xp6(6),e.Q6J("color",("1"===i.details.reservationStatus.reservationStatusId||"4"===i.details.reservationStatus.reservationStatusId?"danger":"")||("2"===i.details.reservationStatus.reservationStatusId?"primary":"")||(null!==(_="3"===i.details.reservationStatus.reservationStatusId)&&void 0!==_?_:"tertiary")),e.xp6(1),e.hij(" ",i.details.reservationStatus.name," "),e.xp6(7),e.Oqu(i.details.reservationLevel.name),e.xp6(5),e.Oqu(e.xi3(27,13,i.details.reqCompletionDate,"MMMM dd, YYYY")),e.xp6(6),e.Oqu(i.details.description),e.xp6(2),e.Oqu(""!==i.details.description?"Remarks":"No Remarks"),e.xp6(6),e.Q6J("ngIf","1"===i.details.reservationStatus.reservationStatusId),e.xp6(1),e.Q6J("lines",i.details.orderItems.length>1?"":"none"),e.xp6(1),e.Q6J("ngForOf",i.details.orderItems)}}function l(A,m){1&A&&(e.TgZ(0,"div",10)(1,"ion-item",11)(2,"ion-label",12)(3,"h3",14)(4,"strong")(5,"ion-text"),e._UZ(6,"ion-skeleton-text",31),e.qZA()()(),e.TgZ(7,"h3",16),e._UZ(8,"ion-skeleton-text",31),e.qZA()()(),e.TgZ(9,"ion-item",11)(10,"ion-label",12)(11,"div",32)(12,"h1",13),e._UZ(13,"ion-skeleton-text",31),e.qZA(),e.TgZ(14,"h3",14),e._UZ(15,"ion-skeleton-text",31),e.qZA()()()(),e.TgZ(16,"ion-item",11),e._UZ(17,"ion-icon",18),e.TgZ(18,"ion-label",12)(19,"h3",14),e._UZ(20,"ion-skeleton-text",31),e.qZA(),e.TgZ(21,"h3",14),e._UZ(22,"ion-skeleton-text",31),e.qZA()()()()),2&A&&(e.xp6(6),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(5),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(5),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0))}function h(A,m){if(1&A){const i=e.EpF();e.TgZ(0,"ion-button",33),e.NdJ("click",function(){e.CHM(i);const I=e.oxw();return e.KtG(I.onCancelReservation())}),e._uU(1,"Cancel reservation"),e.qZA()}if(2&A){const i=e.oxw();e.Q6J("disabled",i.isLoading)}}class d{modalCtrl;alertController;actionSheetController;platform;pageLoaderService;storageService;userService;appconfig;orderItemService;reservationService;hasChanges=!1;currentUser;isLoading=!1;details={};constructor(m,i,_,I,T,U,K,k,R,F){this.modalCtrl=m,this.alertController=i,this.actionSheetController=_,this.platform=I,this.pageLoaderService=T,this.storageService=U,this.userService=K,this.appconfig=k,this.orderItemService=R,this.reservationService=F,this.platform.backButton.subscribeWithPriority(-1,()=>{this.cancel()})}ngOnInit(){this.getReservation(this.details.reservationId)}getReservation(m){var i=this;return(0,s.Z)(function*(){try{i.isLoading=!0,i.reservationService.getById(m).subscribe(function(){var _=(0,s.Z)(function*(I){I.success?(i.details=I.data,i.details.orderItems=I.data.orderItems.filter(T=>T.entityStatus.entityStatusId===o.n.ACTIVE.toString()),i.isLoading=!1):yield i.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(I.message)?I.message[0]:I.message,buttons:["OK"]})});return function(I){return _.apply(this,arguments)}}(),function(){var _=(0,s.Z)(function*(I){yield i.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(I.message)?I.message[0]:I.message,buttons:["OK"]}),i.isLoading=!1});return function(I){return _.apply(this,arguments)}}())}catch(_){i.isLoading=!1,yield i.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(_.message)?_.message[0]:_.message,buttons:["OK"]})}})()}onAddItem(){var m=this;return(0,s.Z)(function*(){const i=yield m.modalCtrl.create({component:v.Q,cssClass:"modal-fullscreen",componentProps:{reservation:m.details,canEdit:!0,currentUser:m.currentUser}});i.present(),yield i.onWillDismiss().then(function(){var _=(0,s.Z)(function*(I){I.data&&(yield m.getReservation(m.details.reservationId))});return function(I){return _.apply(this,arguments)}}())})()}onOpenItemDetails(m){var i=this;return(0,s.Z)(function*(){const _=yield i.modalCtrl.create({component:v.Q,cssClass:"modal-fullscreen",componentProps:{details:m,reservation:i.details,canEdit:i.details.reservationStatus.reservationStatusId===y.C.PENDING.toString(),currentUser:i.currentUser}});_.present();const{role:T}=yield _.onWillDismiss();"confirm"===T&&(yield i.getReservation(i.details.reservationId))})()}onRemoveItem(m){var i=this;return(0,s.Z)(function*(){try{yield i.presentAlert({header:"Are you sure you want to remove this item?",buttons:[{text:"CANCEL",role:"cancel"},{text:"YES Continue",role:"confirm",handler:(_=(0,s.Z)(function*(){yield i.pageLoaderService.open("Processing please wait..."),i.isLoading=!0,i.orderItemService.delete(m).subscribe(function(){var I=(0,s.Z)(function*(T){T.success?(yield i.pageLoaderService.close(),yield i.presentAlert({header:"Item deleted!",buttons:["OK"]}),i.isLoading=!1,yield i.pageLoaderService.close(),yield i.getReservation(i.details.reservationId)):(yield i.pageLoaderService.close(),i.isLoading=!1,yield i.presentAlert({header:"Try again!",message:Array.isArray(T.message)?T.message[0]:T.message,buttons:["OK"]}))});return function(T){return I.apply(this,arguments)}}(),function(){var I=(0,s.Z)(function*(T){yield i.pageLoaderService.close(),i.isLoading=!1,yield i.presentAlert({header:"Try again!",message:Array.isArray(T.message)?T.message[0]:T.message,buttons:["OK"]})});return function(T){return I.apply(this,arguments)}}())}),function(){return _.apply(this,arguments)})}]})}catch(_){yield i.pageLoaderService.close(),i.isLoading=!1,yield i.presentAlert({header:"Try again!",message:Array.isArray(_.message)?_.message[0]:_.message,buttons:["OK"]})}var _})()}onCancelReservation(){var m=this;return(0,s.Z)(function*(){var i;yield m.presentAlert({header:"Are you sure you want to cancel reservation?",buttons:[{text:"BACK",role:"cancel"},{text:"YES",role:"confirm",handler:(i=(0,s.Z)(function*(){m.cancelReservation()}),function(){return i.apply(this,arguments)})}]})})()}cancelReservation(){var m=this;return(0,s.Z)(function*(){try{yield m.pageLoaderService.open("Processing please wait..."),m.isLoading=!0,m.reservationService.updateReservationStatus({reservationId:m.details.reservationId,reservationStatusId:y.C.CANCELLED}).subscribe(function(){var i=(0,s.Z)(function*(_){if(_.success)return m.hasChanges=!0,yield m.pageLoaderService.close(),yield m.presentAlert({header:"Reservation cancelled!",buttons:["OK"]}),m.isLoading=!1,m.modalCtrl.dismiss(!0,"confirm");yield m.pageLoaderService.close(),m.isLoading=!1,yield m.presentAlert({header:"Try again!",message:Array.isArray(_.message)?_.message[0]:_.message,buttons:["OK"]})});return function(_){return i.apply(this,arguments)}}(),function(){var i=(0,s.Z)(function*(_){yield m.pageLoaderService.close(),m.isLoading=!1,yield m.presentAlert({header:"Try again!",message:Array.isArray(_.message)?_.message[0]:_.message,buttons:["OK"]})});return function(_){return i.apply(this,arguments)}}())}catch(i){yield m.pageLoaderService.close(),m.isLoading=!1,yield m.presentAlert({header:"Try again!",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]})}})()}cancel(){return this.modalCtrl.dismiss(this.hasChanges?this.hasChanges:null,"cancel")}presentAlert(m){var i=this;return(0,s.Z)(function*(){yield(yield i.alertController.create(m)).present()})()}static \u0275fac=function(i){return new(i||d)(e.Y36(p.IN),e.Y36(p.Br),e.Y36(p.BX),e.Y36(p.t4),e.Y36(E.p),e.Y36(P.V),e.Y36(D.K),e.Y36(f._),e.Y36(t.R),e.Y36(O.D))};static \u0275cmp=e.Xpm({type:d,selectors:[["app-booking-details"]],decls:14,vars:4,consts:[["slot","start"],[3,"disabled","click"],["name","chevron-back"],[2,"text-align","center"],["slot","end",2,"width","48px"],[1,"ion-padding"],["class","details-container",4,"ngIf","ngIfElse"],["loading",""],[1,"sched-controls-bottom"],["color","danger","expand","block","fill","outline",3,"disabled","click",4,"ngIf"],[1,"details-container"],[1,"item"],["text-wrap",""],[1,"title"],[1,"sub"],[3,"color"],[1,"desc"],["name","alert-circle","slot","start"],["name","today","slot","start"],["name","pricetag","slot","start"],["button","","class","ion-no-padding","detail","false",3,"click",4,"ngIf"],[3,"lines"],["button","","detail","false","class","item",4,"ngFor","ngForOf"],["button","","detail","false",1,"ion-no-padding",3,"click"],["name","add-outline"],["button","","detail","false",1,"item"],[3,"click"],[1,"attribute"],[1,"remarks","sub"],["name","trash-outline",3,"click",4,"ngIf"],["name","trash-outline",3,"click"],[3,"animated"],[1,"item","type"],["color","danger","expand","block","fill","outline",3,"disabled","click"]],template:function(i,_){if(1&i&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return _.cancel()}),e._UZ(4,"ion-icon",2),e.qZA()(),e.TgZ(5,"ion-title",3),e._uU(6,"Details"),e.qZA(),e._UZ(7,"div",4),e.qZA()(),e.TgZ(8,"ion-content",5),e.YNc(9,g,43,16,"div",6),e.YNc(10,l,23,6,"ng-template",null,7,e.W1O),e.qZA(),e.TgZ(12,"div",8),e.YNc(13,h,2,1,"ion-button",9),e.qZA()),2&i){const I=e.MAs(11);e.xp6(3),e.Q6J("disabled",_.isLoading),e.xp6(6),e.Q6J("ngIf",!_.isLoading)("ngIfElse",I),e.xp6(4),e.Q6J("ngIf",!_.isLoading&&"1"===_.details.reservationStatus.reservationStatusId)}},dependencies:[M.sg,M.O5,p.YG,p.Sm,p.W2,p.Gu,p.gu,p.Ie,p.Q$,p.q_,p.CK,p.yW,p.wd,p.sr,M.uU,S.O],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}.message-header-button[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{position:absolute;z-index:9;top:0;right:-10px;font-size:12px}.video-conference-button.disabled[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#0003!important}.video-conference-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#26a69a}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{color:#000!important;display:flex;flex-direction:column}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{margin:5px 0!important}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]{color:#999!important}.details-container[_ngcontent-%COMP%]   .item.type[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:500}.sched-controls-bottom[_ngcontent-%COMP%]{position:relative;display:block;width:100%;background:#ffffff;padding:5px 10px;box-shadow:0 3px 10px #0003}.sched-controls-bottom[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:45px;font-size:15px}.photos[_ngcontent-%COMP%]{row-gap:10px;display:flex;flex-direction:column;box-sizing:border-box;width:100%;padding:10px}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:auto}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:200px;border-radius:10px;object-position:center;object-fit:contain;box-shadow:0 0 10px #7a7a7a75}"]})}},8164:(x,C,r)=>{r.d(C,{Q:()=>N});var s=r(5861),o=r(4006),y=r(567);class E{orderItemId;quantity;remarks;orderItemType;reservation;entityStatus;orderItemAttachments}var D=r(8305),f=r(2531),t=r(4650),O=r(603),M=r(7956),S=r(3746),B=r(8386),L=r(9709),Z=r(8791),g=r(1086),l=r(2868),h=r(7221),d=r(2340),A=r(529);class m{http;appconfig;constructor(n,c){this.http=n,this.appconfig=c}getAll(){return this.http.get(d.N.apiBaseUrl+this.appconfig.config.apiEndPoints.orderItemType.getAll).pipe((0,l.b)(n=>this.log("order item type")),(0,h.K)(this.handleError("order item type",[])))}handleError(n="operation",c){return a=>(this.log(`${n} failed: ${Array.isArray(a.error.message)?a.error.message[0]:a.error.message}`),(0,g.of)(a.error))}log(n){console.log(n)}static \u0275fac=function(c){return new(c||m)(t.LFG(A.eN),t.LFG(L._))};static \u0275prov=t.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"})}var i=r(6895),_=r(9549),I=r(4144),T=r(5641),U=r(8559);function K(b,n){if(1&b){const c=t.EpF();t.TgZ(0,"ion-buttons",18)(1,"ion-button",1),t.NdJ("click",function(){t.CHM(c);const u=t.oxw();return t.KtG(u.onSubmit())}),t._UZ(2,"ion-icon",19),t.qZA()()}if(2&b){const c=t.oxw();t.xp6(1),t.Q6J("disabled",c.isLoading||!c.itemForm.valid)}}function k(b,n){1&b&&t._UZ(0,"div",20)}function R(b,n){if(1&b){const c=t.EpF();t.TgZ(0,"ion-list")(1,"ion-item",21),t.NdJ("click",function(){t.CHM(c);const u=t.oxw();return t.KtG(u.onOpenDetails())}),t.TgZ(2,"ion-label")(3,"div")(4,"h3")(5,"strong"),t._uU(6),t.ALo(7,"numberLeadZero"),t.TgZ(8,"ion-text",22),t._uU(9),t.qZA()()()()()()()}if(2&b){const c=t.oxw();let a;t.xp6(6),t.hij("ID #: ",c.reservation?t.xi3(7,3,c.reservation.reservationId,5):""," "),t.xp6(2),t.Q6J("color",("1"===c.reservation.reservationStatus.reservationStatusId||"4"===c.reservation.reservationStatus.reservationStatusId?"danger":"")||("2"===c.reservation.reservationStatus.reservationStatusId?"primary":"")||(null!==(a="3"===c.reservation.reservationStatus.reservationStatusId)&&void 0!==a?a:"tertiary")),t.xp6(1),t.hij(" ",c.reservation.reservationStatus.name," ")}}function F(b,n){if(1&b&&(t.TgZ(0,"ion-select-option",26),t._uU(1),t.qZA()),2&b){const c=n.$implicit;t.s9C("value",c.orderItemTypeId.toString()),t.xp6(1),t.Oqu(c.name)}}function Y(b,n){if(1&b&&(t.TgZ(0,"ion-item",23)(1,"ion-select",24),t.YNc(2,F,2,2,"ion-select-option",25),t.qZA()()),2&b){const c=t.oxw();t.Q6J("disabled",c.isLoading),t.xp6(2),t.Q6J("ngForOf",c.orderItemTypeOption)}}function W(b,n){if(1&b&&(t.TgZ(0,"ion-radio-group")(1,"ion-item",27)(2,"ion-label"),t._uU(3),t.qZA()()()),2&b){const c=t.oxw();t.xp6(3),t.Oqu(c.details.orderItemType.name)}}function J(b,n){1&b&&(t.TgZ(0,"span",28),t._uU(1," Please select a type of item "),t.qZA())}class N{modalCtrl;alertController;actionSheetController;platform;formBuilder;pageLoaderService;storageService;userService;appconfig;orderItemService;orderItemTypeService;modal;canEdit=!1;hasChanges=!1;currentUser;isLoading=!1;isSubmitting=!1;isLoadingFilter=!1;details;reservation;orderItemTypeOption=[];itemForm;orderItemAttachments=[];constructor(n,c,a,u,w,Q,G,H,$,j,V){this.modalCtrl=n,this.alertController=c,this.actionSheetController=a,this.platform=u,this.formBuilder=w,this.pageLoaderService=Q,this.storageService=G,this.userService=H,this.appconfig=$,this.orderItemService=j,this.orderItemTypeService=V,this.platform.backButton.subscribeWithPriority(-1,()=>{this.cancel()})}get isNew(){return!this.details||!this.details.orderItemId&&""===this.details.orderItemId}get formData(){return{...this.itemForm.value,orderItemId:this.isNew?null:this.details.orderItemId,reservationId:this.reservation?this.reservation.reservationId:null,orderItemAttachments:this.orderItemAttachments}}get errorControls(){return this.itemForm.controls}initFilter(){var n=this;this.isLoadingFilter=!0,(0,y.D)([this.orderItemTypeService.getAll()]).subscribe(([c])=>{this.orderItemTypeOption=c.data},c=>console.error(c),(0,s.Z)(function*(){n.isLoadingFilter=!1,n.details&&n.details.orderItemId?(yield n.getOrderItem(n.details.orderItemId),n.itemForm.controls.quantity.setValue(n.details.quantity),n.itemForm.controls.remarks.setValue(n.details.remarks)):n.details&&(n.itemForm.controls.orderItemTypeId.setValue(n.details.orderItemType.orderItemTypeId),n.itemForm.controls.quantity.setValue(n.details.quantity),n.itemForm.controls.remarks.setValue(n.details.remarks))}))}ngOnInit(){this.itemForm=new o.cw({orderItemTypeId:new o.NI(null,o.kI.required),quantity:new o.NI(null,[o.kI.required,o.kI.min(1)]),remarks:new o.NI(null,o.kI.required)}),this.initFilter()}getOrderItem(n){var c=this;return(0,s.Z)(function*(){try{c.isLoading=!0,c.orderItemService.getById(n).subscribe(function(){var a=(0,s.Z)(function*(u){u.success?(c.details={...u.data,...c.details},c.isLoading=!1,c.itemForm.controls.orderItemTypeId.setValue(u.data.orderItemType.orderItemTypeId),c.orderItemAttachments=c.details.orderItemAttachments):yield c.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(u.message)?u.message[0]:u.message,buttons:["OK"]})});return function(u){return a.apply(this,arguments)}}(),function(){var a=(0,s.Z)(function*(u){yield c.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(u.message)?u.message[0]:u.message,buttons:["OK"]}),c.isLoading=!1});return function(u){return a.apply(this,arguments)}}())}catch(a){yield c.presentAlert({header:"Try again!",subHeader:"",message:Array.isArray(a.message)?a.message[0]:a.message,buttons:["OK"]})}})()}onSubmit(){var n=this;return(0,s.Z)(function*(){const c=n.formData;try{if(n.isSubmitting=!0,n.isNew)if(n.reservation&&""!==n.reservation.reservationId)yield n.pageLoaderService.open("Saving item..."),n.orderItemService.create(c).subscribe(function(){var a=(0,s.Z)(function*(u){u.success?(yield n.presentAlert({header:"Saved!",buttons:["OK"]}),n.isSubmitting=!1,n.modal.canDismiss=!0,n.modal.dismiss({success:!0,data:u.data},"confirm"),yield n.pageLoaderService.close()):(yield n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(u.message)?u.message[0]:u.message,buttons:["OK"]}))});return function(u){return a.apply(this,arguments)}}(),function(){var a=(0,s.Z)(function*(u){yield n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(u.message)?u.message[0]:u.message,buttons:["OK"]})});return function(u){return a.apply(this,arguments)}}());else{const a=new E;a.quantity=n.formData.quantity,a.orderItemType=n.orderItemTypeOption.filter(u=>u.orderItemTypeId===n.formData.orderItemTypeId)[0],a.remarks=n.formData.remarks,a.orderItemAttachments=n.formData.orderItemAttachments,n.modal.dismiss({success:!0,data:a},"confirm")}else if(n.details&&n.details.reservation&&""!==n.details.reservation.reservationId)yield n.pageLoaderService.open("Saving item..."),n.orderItemService.update(c).subscribe(function(){var a=(0,s.Z)(function*(u){u.success?(yield n.presentAlert({header:"Saved!",buttons:["OK"]}),n.isSubmitting=!1,n.modal.canDismiss=!0,n.modal.dismiss({success:!0,data:u.data},"confirm"),yield n.pageLoaderService.close()):(yield n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(u.message)?u.message[0]:u.message,buttons:["OK"]}))});return function(u){return a.apply(this,arguments)}}(),function(){var a=(0,s.Z)(function*(u){yield n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(u.message)?u.message[0]:u.message,buttons:["OK"]})});return function(u){return a.apply(this,arguments)}}());else{const a=new E;a.quantity=n.formData.quantity,a.orderItemType=n.orderItemTypeOption.filter(u=>u.orderItemTypeId===n.formData.orderItemTypeId)[0],a.remarks=n.formData.remarks,n.modal.dismiss({success:!0,data:a},"confirm")}}catch(a){yield n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(a.message)?a.message[0]:a.message,buttons:["OK"]})}})()}delete(){var n=this;return(0,s.Z)(function*(){try{yield n.pageLoaderService.open("Processing please wait..."),n.isLoading=!0,n.orderItemService.delete(n.details.orderItemId).subscribe(function(){var c=(0,s.Z)(function*(a){if(a.success)return n.hasChanges=!0,yield n.pageLoaderService.close(),yield n.presentAlert({header:"Item deleted!",buttons:["OK"]}),n.isLoading=!1,n.modalCtrl.dismiss(!0,"confirm");yield n.pageLoaderService.close(),n.isLoading=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(a.message)?a.message[0]:a.message,buttons:["OK"]})});return function(a){return c.apply(this,arguments)}}(),function(){var c=(0,s.Z)(function*(a){yield n.pageLoaderService.close(),n.isLoading=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(a.message)?a.message[0]:a.message,buttons:["OK"]})});return function(a){return c.apply(this,arguments)}}())}catch(c){yield n.pageLoaderService.close(),n.isLoading=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(c.message)?c.message[0]:c.message,buttons:["OK"]})}})()}onOpenDetails(){var n=this;return(0,s.Z)(function*(){n.modalCtrl.dismiss();const c=yield n.modalCtrl.create({component:D.O,cssClass:"modal-fullscreen",componentProps:{details:n.reservation,currentUser:n.currentUser}});c.present(),yield c.onWillDismiss()})()}openAttachment(){var n=this;return(0,s.Z)(function*(){const c=yield n.modalCtrl.create({component:f.n,cssClass:"modal-fullscreen",componentProps:{isNew:n.isNew,currentUser:n.currentUser,orderItemAttachments:n.orderItemAttachments&&n.orderItemAttachments.length>0?n.orderItemAttachments.sort((a,u)=>Number(u.orderItemAttachmentId)-Number(a.orderItemAttachmentId)):[],orderItemId:n.details&&n.details.orderItemId?n.details.orderItemId:null}});c.present(),yield c.onWillDismiss().then(function(){var a=(0,s.Z)(function*(u){u.data&&(n.orderItemAttachments=u.data)});return function(u){return a.apply(this,arguments)}}())})()}cancel(){return this.modalCtrl.dismiss(this.hasChanges?this.hasChanges:null,"cancel")}presentAlert(n){var c=this;return(0,s.Z)(function*(){yield(yield c.alertController.create(n)).present()})()}static \u0275fac=function(c){return new(c||N)(t.Y36(O.IN),t.Y36(O.Br),t.Y36(O.BX),t.Y36(O.t4),t.Y36(o.qu),t.Y36(M.p),t.Y36(S.V),t.Y36(B.K),t.Y36(L._),t.Y36(Z.R),t.Y36(m))};static \u0275cmp=t.Xpm({type:N,selectors:[["app-booking-item-add"]],decls:34,vars:12,consts:[["slot","start"],[3,"disabled","click"],["name","chevron-back"],[2,"text-align","center"],["slot","end",4,"ngIf"],["slot","end","style","width: 48px",4,"ngIf"],[1,"ion-padding"],["id","itemForm",3,"formGroup","ngSubmit"],[4,"ngIf"],[1,"form-field-group"],["fill","outline",3,"disabled",4,"ngIf"],["class","error",4,"ngIf"],["appearance","outline"],["matInput","","type","number","placeholder","Quantity","formControlName","quantity","autocomplete","new-quantity",3,"readonly"],["matInput","","type","text","placeholder","Remarks","formControlName","remarks","autocomplete","new-quantity",2,"height","200px",3,"readonly"],["lines","full"],["button","","detail","true",3,"click"],["slot","icon-only","name","chevron-forward-outline"],["slot","end"],["name","checkmark-outline"],["slot","end",2,"width","48px"],["lines","none","button","","detail","true",3,"click"],[3,"color"],["fill","outline",3,"disabled"],["slot","start","formControlName","orderItemTypeId","placeholder","Select type"],["slot","start",3,"value",4,"ngFor","ngForOf"],["slot","start",3,"value"],["fill","outline","lines","none"],[1,"error"]],template:function(c,a){1&c&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return a.cancel()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-title",3),t._uU(6),t.qZA(),t.YNc(7,K,3,1,"ion-buttons",4),t.YNc(8,k,1,0,"div",5),t.qZA()(),t.TgZ(9,"ion-content",6)(10,"form",7),t.NdJ("ngSubmit",function(){return a.onSubmit()}),t.TgZ(11,"fieldset"),t.YNc(12,R,10,6,"ion-list",8),t.TgZ(13,"div",9)(14,"mat-label",0),t._uU(15,"What type of item"),t.qZA(),t.YNc(16,Y,3,2,"ion-item",10),t.YNc(17,W,4,1,"ion-radio-group",8),t.YNc(18,J,2,0,"span",11),t.qZA(),t.TgZ(19,"div",9)(20,"mat-form-field",12)(21,"mat-label"),t._uU(22,"Quantity"),t.qZA(),t._UZ(23,"input",13),t.qZA()(),t.TgZ(24,"div",9)(25,"mat-form-field",12)(26,"mat-label"),t._uU(27,"Remarks"),t.qZA(),t._UZ(28,"textarea",14),t.qZA()()()(),t.TgZ(29,"ion-list",15)(30,"ion-item",16),t.NdJ("click",function(){return a.openAttachment()}),t.TgZ(31,"ion-label"),t._uU(32),t.qZA(),t._UZ(33,"ion-icon",17),t.qZA()()()),2&c&&(t.xp6(3),t.Q6J("disabled",a.isLoading),t.xp6(3),t.Oqu(a.isLoading?"":a.isNew?"New item":a.canEdit?"Edit item":"Details"),t.xp6(1),t.Q6J("ngIf",a.canEdit),t.xp6(1),t.Q6J("ngIf",!a.canEdit),t.xp6(2),t.Q6J("formGroup",a.itemForm),t.xp6(2),t.Q6J("ngIf",!a.isLoading&&(a.reservation&&!a.isNew||a.reservation&&a.isNew)),t.xp6(4),t.Q6J("ngIf",a.canEdit),t.xp6(1),t.Q6J("ngIf",!a.canEdit),t.xp6(1),t.Q6J("ngIf",a.errorControls.orderItemTypeId.touched&&a.errorControls.orderItemTypeId.errors&&a.errorControls.orderItemTypeId.errors.required),t.xp6(5),t.Q6J("readonly",!a.canEdit),t.xp6(5),t.Q6J("readonly",!a.canEdit),t.xp6(4),t.hij("Attachments(",a.orderItemAttachments?a.orderItemAttachments.length:0,")"))},dependencies:[i.sg,i.O5,o._Y,o.Fj,o.wV,o.JJ,o.JL,o.sg,o.u,O.YG,O.Sm,O.W2,O.Gu,O.gu,O.Ie,O.Q$,O.q_,O.se,O.t9,O.n0,O.yW,O.wd,O.sr,O.QI,_.KE,_.hX,I.Nt,T.f,U.O],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}"]})}},2531:(x,C,r)=>{r.d(C,{n:()=>L});var s=r(5861),o=r(6388),y=r(1067),v=r(5794),e=r(4650),p=r(603),E=r(7956),P=r(8791),D=r(6895),f=r(6351);function t(Z,g){if(1&Z){const l=e.EpF();e.TgZ(0,"ion-button",1),e.NdJ("click",function(){e.CHM(l);const d=e.oxw();return e.KtG(d.done())}),e._UZ(1,"ion-icon",12),e.qZA()}}function O(Z,g){1&Z&&e._UZ(0,"div",13)}function M(Z,g){if(1&Z){const l=e.EpF();e.TgZ(0,"ion-avatar")(1,"ion-fab-button",16),e.NdJ("click",function(){const A=e.CHM(l).$implicit,m=e.oxw(2);return e.KtG(m.onRemovePhoto(A))}),e._UZ(2,"ion-icon",17),e.qZA(),e.TgZ(3,"ion-img-viewer",18),e.NdJ("error",function(d){e.CHM(l);const A=e.oxw(2);return e.KtG(A.imageErrorHandler(d))}),e.qZA()()}if(2&Z){const l=g.$implicit,h=e.oxw(2);e.xp6(3),e.Q6J("src",h.isNew||l.isNew?l?l.url:"":l.file?l.file.url:"")}}function S(Z,g){if(1&Z&&(e.TgZ(0,"div",14),e.YNc(1,M,4,1,"ion-avatar",15),e.qZA()),2&Z){const l=e.oxw();e.xp6(1),e.Q6J("ngForOf",l.orderItemAttachments)}}function B(Z,g){1&Z&&(e.TgZ(0,"div",19),e._UZ(1,"ion-icon",20),e.TgZ(2,"h3",21),e._uU(3,"No attachments to show"),e.qZA()())}class L{modalCtrl;platform;alertController;pageLoaderService;orderItemService;actionSheetController;isNew=!1;modal;orderItemAttachments=[];isLoading=!1;orderItemId;constructor(g,l,h,d,A,m){this.modalCtrl=g,this.platform=l,this.alertController=h,this.pageLoaderService=d,this.orderItemService=A,this.actionSheetController=m}ngOnInit(){}onAddPhoto(){var g=this;return(0,s.Z)(function*(){const l=yield g.actionSheetController.create({cssClass:"sched-card-action-sheet",buttons:[{text:"Camera",handler:(h=(0,s.Z)(function*(){const d=yield o.V1.getPhoto({quality:90,allowEditing:!1,resultType:o.dk.Uri,source:o.oK.Camera});if(d){const A=yield g.readAsBase64(d),i={id:g.orderItemAttachments.length>0?g.orderItemAttachments[g.orderItemAttachments.length-1]:1,fileName:`profile-sample-name.${d.format}`,data:A,url:`data:image/${d.format};base64,${A}`,isNew:!0};g.orderItemId&&""!==g.orderItemId?yield g.saveAttachments(i):g.orderItemAttachments=[i,...g.orderItemAttachments]}l.dismiss()}),function(){return h.apply(this,arguments)})},{text:"Gallery",handler:function(){var h=(0,s.Z)(function*(){const d=yield o.V1.getPhoto({quality:90,allowEditing:!1,resultType:o.dk.Uri,source:o.oK.Photos});if(d){const A=yield g.readAsBase64(d),i={id:g.orderItemAttachments.length>0?g.orderItemAttachments[g.orderItemAttachments.length-1]:1,fileName:`profile-sample-name.${d.format}`,data:A,url:`data:image/${d.format};base64,${A}`,isNew:!0};g.orderItemId&&""!==g.orderItemId?yield g.saveAttachments(i):g.orderItemAttachments=[i,...g.orderItemAttachments]}l.dismiss()});return function(){return h.apply(this,arguments)}}()},{text:"Cancel",handler:function(){var h=(0,s.Z)(function*(){l.dismiss()});return function(){return h.apply(this,arguments)}}()}]});var h;yield l.present()})()}onRemovePhoto(g){var l=this;return(0,s.Z)(function*(){var h;g.isNew?l.orderItemAttachments=l.orderItemAttachments.filter(h=>h.id!==g.id):yield l.presentAlert({header:"Are you sure you want to remove this attachment?",buttons:[{text:"CANCEL",role:"cancel"},{text:"YES Continue",role:"confirm",handler:(h=(0,s.Z)(function*(){yield l.removePhoto(g)}),function(){return h.apply(this,arguments)})}]})})()}removePhoto(g){var l=this;return(0,s.Z)(function*(){try{yield l.pageLoaderService.open("Processing please wait..."),l.isLoading=!0,l.orderItemService.removeAttachmentFile(g.orderItemAttachmentId).subscribe(function(){var h=(0,s.Z)(function*(d){d.success?(yield l.pageLoaderService.close(),yield l.presentAlert({header:"Removed!",buttons:["OK"]}),l.isLoading=!1,l.orderItemAttachments=d.data.sort((A,m)=>Number(m.orderItemAttachmentId)-Number(A.orderItemAttachmentId))):(yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]}))});return function(d){return h.apply(this,arguments)}}(),function(){var h=(0,s.Z)(function*(d){yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]})});return function(d){return h.apply(this,arguments)}}())}catch(h){yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(h.message)?h.message[0]:h.message,buttons:["OK"]})}})()}done(){var g=this;return(0,s.Z)(function*(){g.modal.canDismiss=!0,g.modalCtrl.dismiss(g.orderItemAttachments,"done")})()}saveAttachments(g){var l=this;return(0,s.Z)(function*(){g={...g,orderItemId:l.orderItemId};try{l.isLoading=!0,yield l.pageLoaderService.open("Saving attachment..."),l.orderItemService.addAttachmentFile(g).subscribe(function(){var h=(0,s.Z)(function*(d){d.success?(yield l.presentAlert({header:"Saved!",buttons:["OK"]}),l.isLoading=!1,l.orderItemAttachments=d.data.sort((A,m)=>Number(m.orderItemAttachmentId)-Number(A.orderItemAttachmentId)),yield l.pageLoaderService.close()):(yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]}))});return function(d){return h.apply(this,arguments)}}(),function(){var h=(0,s.Z)(function*(d){yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]})});return function(d){return h.apply(this,arguments)}}())}catch(h){yield l.pageLoaderService.close(),l.isLoading=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(h.message)?h.message[0]:h.message,buttons:["OK"]})}})()}readAsBase64(g){var l=this;return(0,s.Z)(function*(){if(l.platform.is("hybrid"))return(yield y.fy.readFile({path:g.path})).data;{const d=yield(yield fetch(g.webPath)).blob();return(yield l.convertBlobToBase64(d)).split(",")[1]}})()}convertBlobToBase64=g=>new Promise((l,h)=>{const d=new FileReader;d.onerror=h,d.onload=()=>{l(d.result)},d.readAsDataURL(g)});imageErrorHandler(g){return(0,s.Z)(function*(){g.target.src="../../../../assets/img/error_black.png"})()}onViewImage(g){var l=this;return(0,s.Z)(function*(){if(g&&g.source){const h=yield l.modalCtrl.create({component:v.r,cssClass:"modal-fullscreen",componentProps:{file:{url:g.source}}});h.present(),yield h.onWillDismiss()}})()}cancel(){this.modal.canDismiss=!0,this.modalCtrl.dismiss(this.orderItemAttachments,"cancel")}presentAlert(g){var l=this;return(0,s.Z)(function*(){yield(yield l.alertController.create(g)).present()})()}static \u0275fac=function(l){return new(l||L)(e.Y36(p.IN),e.Y36(p.t4),e.Y36(p.Br),e.Y36(E.p),e.Y36(P.R),e.Y36(p.BX))};static \u0275cmp=e.Xpm({type:L,selectors:[["app-booking-item-attachments"]],decls:17,vars:4,consts:[["slot","start"],[3,"click"],["name","chevron-back"],[2,"text-align","center"],["slot","end"],[3,"click",4,"ngIf"],["slot","end","style","width: 48px",4,"ngIf"],[1,"ion-padding"],["slot","fixed","vertical","bottom","horizontal","end"],["name","image-outline"],["class","photos",4,"ngIf","ngIfElse"],["elseNoRecords",""],["name","checkmark-outline"],["slot","end",2,"width","48px"],[1,"photos"],[4,"ngFor","ngForOf"],["size","small","color","danger",1,"remove-button",3,"click"],["name","close"],["scheme","dark",3,"src","error"],[1,"no-records"],["name","images-outline",2,"font-size","4em"],[1,"text"]],template:function(l,h){if(1&l&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return h.cancel()}),e._UZ(4,"ion-icon",2),e.qZA()(),e.TgZ(5,"ion-title",3),e._uU(6,"Attachments"),e.qZA(),e.TgZ(7,"ion-buttons",4),e.YNc(8,t,2,0,"ion-button",5),e.qZA(),e.YNc(9,O,1,0,"div",6),e.qZA()(),e.TgZ(10,"ion-content",7)(11,"ion-fab",8)(12,"ion-fab-button",1),e.NdJ("click",function(){return h.onAddPhoto()}),e._UZ(13,"ion-icon",9),e.qZA()(),e.YNc(14,S,2,1,"div",10),e.YNc(15,B,4,0,"ng-template",null,11,e.W1O),e.qZA()),2&l){const d=e.MAs(16);e.xp6(8),e.Q6J("ngIf",h.isNew&&h.orderItemAttachments.length>0),e.xp6(1),e.Q6J("ngIf",!h.isNew),e.xp6(5),e.Q6J("ngIf",h.orderItemAttachments.length>0)("ngIfElse",d)}},dependencies:[D.sg,D.O5,p.BJ,p.YG,p.Sm,p.W2,p.IJ,p.W4,p.Gu,p.gu,p.wd,p.sr,f.A6],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%], p[_ngcontent-%COMP%], span[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{margin:0!important}.photos[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column;gap:10px}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{display:flex;height:auto;width:100%;position:relative;min-height:40px}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   ion-img-viewer[_ngcontent-%COMP%]{display:flex!important;flex-grow:1!important;height:100%;width:100%!important;justify-content:center}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   ion-img-viewer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%!important;object-fit:contain!important}.photos[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   .remove-button[_ngcontent-%COMP%]{position:absolute;right:-15px;top:-15px}"]})}}}]);